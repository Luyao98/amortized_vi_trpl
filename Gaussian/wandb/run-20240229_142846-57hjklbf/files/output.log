/home/luyao/amortized_vi_trpl/2DGaussian/model.py:142: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  contexts = torch.tensor(contexts, dtype=torch.float32).to(device)
Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 172, in <module>
    model_samples = model.get_samples(mean_pred, chol_pred)
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 69, in get_samples
    normal_distribution = torch.distributions.MultivariateNormal(mean, cov)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/distributions/multivariate_normal.py", line 150, in __init__
    super(MultivariateNormal, self).__init__(batch_shape, event_shape, validate_args=validate_args)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/distributions/distribution.py", line 57, in __init__
    f"Expected parameter {param} "
ValueError: Expected parameter covariance_matrix (Tensor of shape (16, 2, 2)) of distribution MultivariateNormal(loc: torch.Size([16, 2]), covariance_matrix: torch.Size([16, 2, 2])) to satisfy the constraint PositiveDefinite(), but found invalid values:
tensor([[[ 1.2935e-02,  4.8644e-02],
         [ 4.8644e-02,  1.8306e-01]],
        [[ 1.1369e+00,  1.7225e-01],
         [ 1.7225e-01,  1.6662e-01]],
        [[ 6.3057e-01, -1.1080e-01],
         [-1.1080e-01,  4.8486e-02]],
        [[ 2.9280e-01,  8.8456e-02],
         [ 8.8456e-02,  9.0041e-02]],
        [[ 4.3973e-05, -1.4137e-03],
         [-1.4137e-03,  4.5455e-02]],
        [[ 3.2434e-03, -8.0235e-02],
         [-8.0235e-02,  2.0061e+00]],
        [[ 1.9019e+00,  9.6865e-01],
         [ 9.6865e-01,  4.9375e-01]],
        [[ 3.5734e-10, -9.9305e-05],
         [-9.9305e-05,  2.7597e+01]],
        [[ 1.1253e-07, -1.3473e-03],
         [-1.3473e-03,  1.6131e+01]],
        [[ 1.1752e-10, -7.4099e-05],
         [-7.4099e-05,  4.6720e+01]],
        [[ 2.2542e-02, -1.5123e-01],
         [-1.5123e-01,  1.0185e+00]],
        [[ 1.8145e+00,  8.2378e-01],
         [ 8.2378e-01,  3.7482e-01]],
        [[ 1.3184e-02,  2.3036e-02],
         [ 2.3036e-02,  4.0968e-02]],
        [[ 6.8597e-10, -1.4394e-04],
         [-1.4394e-04,  3.0205e+01]],
        [[ 1.0297e-10, -7.9307e-05],
         [-7.9307e-05,  6.1084e+01]],
        [[ 1.6723e-05, -3.8369e-03],
         [-3.8369e-03,  8.8036e-01]]], grad_fn=<ExpandBackward0>)