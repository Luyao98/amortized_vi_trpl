/home/luyao/amortized_vi_trpl/2DGaussian/model.py:143: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  contexts = torch.tensor(contexts, dtype=torch.float32).to(device)
Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 173, in <module>
    model_samples = model.get_samples(mean_pred, chol_pred)
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 70, in get_samples
    normal_distribution = torch.distributions.MultivariateNormal(mean, cov)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/distributions/multivariate_normal.py", line 150, in __init__
    super(MultivariateNormal, self).__init__(batch_shape, event_shape, validate_args=validate_args)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/distributions/distribution.py", line 57, in __init__
    f"Expected parameter {param} "
ValueError: Expected parameter covariance_matrix (Tensor of shape (16, 2, 2)) of distribution MultivariateNormal(loc: torch.Size([16, 2]), covariance_matrix: torch.Size([16, 2, 2])) to satisfy the constraint PositiveDefinite(), but found invalid values:
tensor([[[ 1.1444e+01,  2.0219e+00],
         [ 2.0219e+00,  2.0986e+00]],
        [[ 1.7397e+00,  2.2759e-01],
         [ 2.2759e-01,  1.3742e+00]],
        [[ 1.1297e+01,  4.2702e+01],
         [ 4.2702e+01,  2.3054e+02]],
        [[ 1.2802e+01,  5.2057e+00],
         [ 5.2057e+00,  6.4115e+00]],
        [[ 3.0354e+01, -2.0985e+00],
         [-2.0985e+00,  2.4117e-01]],
        [[ 9.6198e+01,  4.4885e+00],
         [ 4.4885e+00,  6.4363e+01]],
        [[ 1.0605e-01,  9.2930e-01],
         [ 9.2930e-01,  2.7573e+02]],
        [[ 2.4269e+00,  2.3593e+01],
         [ 2.3593e+01,  6.7075e+02]],
        [[ 2.6864e+00,  1.3529e+00],
         [ 1.3529e+00,  3.2965e+00]],
        [[ 5.6694e+00,  2.1705e+00],
         [ 2.1705e+00,  5.1809e+00]],
        [[ 8.2972e+01,  5.3974e+01],
         [ 5.3974e+01,  5.4541e+01]],
        [[ 3.3621e+00,  1.3764e+00],
         [ 1.3764e+00,  1.5045e+00]],
        [[ 2.9764e+01,  4.2057e+01],
         [ 4.2057e+01,  6.9489e+01]],
        [[ 1.8846e+01,  4.9555e+01],
         [ 4.9555e+01,  1.3958e+02]],
        [[ 5.4356e+02, -1.7980e+01],
         [-1.7980e+01,  5.9478e-01]],
        [[ 7.2652e-01,  5.4438e-01],
         [ 5.4438e-01,  4.4104e+00]]], grad_fn=<ExpandBackward0>)