/home/luyao/amortized_vi_trpl/2DGaussian/model.py:144: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  contexts = torch.tensor(contexts, dtype=torch.float32).to(device)
Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 174, in <module>
    model_samples = model.get_samples(mean_pred, chol_pred)
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 71, in get_samples
    normal_distribution = torch.distributions.MultivariateNormal(mean, cov)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/distributions/multivariate_normal.py", line 150, in __init__
    super(MultivariateNormal, self).__init__(batch_shape, event_shape, validate_args=validate_args)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/distributions/distribution.py", line 57, in __init__
    f"Expected parameter {param} "
ValueError: Expected parameter covariance_matrix (Tensor of shape (16, 2, 2)) of distribution MultivariateNormal(loc: torch.Size([16, 2]), covariance_matrix: torch.Size([16, 2, 2])) to satisfy the constraint PositiveDefinite(), but found invalid values:
tensor([[[ 4.2436e-13, -6.5870e-06],
         [-6.5870e-06,  1.0224e+02]],
        [[ 1.7371e+00, -7.3047e-01],
         [-7.3047e-01,  3.0756e-01]],
        [[ 1.2946e+00, -5.9992e-01],
         [-5.9992e-01,  2.8084e-01]],
        [[ 2.1774e-08, -8.9649e-04],
         [-8.9649e-04,  3.6910e+01]],
        [[ 3.3991e-02, -3.2974e-01],
         [-3.2974e-01,  3.1986e+00]],
        [[ 1.2637e+00, -5.0798e-01],
         [-5.0798e-01,  2.1650e-01]],
        [[ 2.3032e+00, -1.0109e+00],
         [-1.0109e+00,  4.4378e-01]],
        [[ 1.8694e-01, -3.7411e-01],
         [-3.7411e-01,  7.4869e-01]],
        [[ 4.4422e-01, -3.0793e-01],
         [-3.0793e-01,  2.7568e-01]],
        [[ 3.5124e-03, -1.2999e-01],
         [-1.2999e-01,  4.8107e+00]],
        [[ 1.6646e+00, -7.3942e-01],
         [-7.3942e-01,  3.2913e-01]],
        [[ 4.9156e-04, -5.9362e-02],
         [-5.9362e-02,  7.1790e+00]],
        [[ 1.4676e-12, -1.1741e-05],
         [-1.1741e-05,  9.3928e+01]],
        [[ 3.6725e-01, -6.0450e-01],
         [-6.0450e-01,  9.9503e-01]],
        [[ 1.4966e+00, -5.7714e-01],
         [-5.7714e-01,  2.2290e-01]],
        [[ 3.0742e-08, -1.0461e-03],
         [-1.0461e-03,  3.5595e+01]]], grad_fn=<ExpandBackward0>)