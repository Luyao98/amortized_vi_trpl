
torch.Size([16, 2, 2])
/home/luyao/amortized_vi_trpl/2DGaussian/model.py:143: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  contexts = torch.tensor(contexts, dtype=torch.float32).to(device)
Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 172, in <module>
    mean_pred, chol_pred = model(batch_contexts)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 43, in forward
    cholesky = diag_bijector(lambda z: self.diag_activation(z + self.get_activation_shift()) + self.minimal_std, chol)
  File "/home/luyao/amortized_vi_trpl/2DGaussian/utils.py", line 194, in diag_bijector
    return x.tril(-1) + f(x.diagonal(dim1=-2, dim2=-1)).diag_embed() + x.triu(1)
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 43, in <lambda>
    cholesky = diag_bijector(lambda z: self.diag_activation(z + self.get_activation_shift()) + self.minimal_std, chol)
  File "/home/luyao/amortized_vi_trpl/2DGaussian/model.py", line 49, in get_activation_shift
    return self.diag_activation_inv(init_std - minimal_std)
  File "/home/luyao/amortized_vi_trpl/2DGaussian/utils.py", line 206, in inverse_softplus
    return (x.exp() - 1.).log()
AttributeError: 'float' object has no attribute 'exp'