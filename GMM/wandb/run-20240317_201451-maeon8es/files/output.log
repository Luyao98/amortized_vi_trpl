Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 168, in <module>
    train_model(model, target, n_epochs, batch_size, n_context, n_components, eps, beta, alpha, optimizer, device)
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 115, in train_model
    loss.backward(retain_graph=True)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
RuntimeError: one of the variables needed for gradient computation has been modified by an inplace operation: [torch.FloatTensor [64, 3]], which is output 0 of AsStridedBackward0, is at version 2; expected version 1 instead. Hint: enable anomaly detection to find the operation that failed to compute its gradient, with torch.autograd.set_detect_anomaly(True).
tensor([[ 0.9132],
        [-2.9594],
        [-2.9438],
        [ 0.2623],
        [-1.8483],
        [ 2.9773],
        [-1.1673],
        [ 0.5483],
        [-2.5856],
        [-2.1967],
        [-1.8021],
        [ 1.0304],
        [-2.3138],
        [ 0.6844],
        [ 2.4737],
        [-1.1124],
        [-1.4445],
        [-2.7460],
        [ 2.5820],
        [ 1.9777],
        [ 1.8232],
        [ 1.5821],
        [ 2.6099],
        [-2.0835],
        [ 2.8266],
        [ 0.8480],
        [-0.5673],
        [-1.1166],
        [-0.4342],
        [-0.4662],
        [ 0.0555],
        [ 2.8099],
        [ 1.7271],
        [ 1.7047],
        [ 1.0014],
        [-2.1485],
        [ 2.5284],
        [-2.4627],
        [ 1.5422],
        [ 2.9578],
        [ 2.1332],
        [ 2.7252],
        [-0.0759],
        [-0.2970],
        [ 1.4737],
        [ 1.1864],
        [ 2.6407],
        [ 0.1709],
        [-0.1639],
        [-1.2317],
        [-0.6442],
        [ 0.2109],
        [-0.8705],
        [-1.6602],
        [ 0.6137],
        [-1.6068],
        [-1.8665],
        [-1.6248],
        [-2.0449],
        [ 1.2657],
        [ 1.2531],
        [ 1.5816],
        [ 0.5434],
        [ 1.0188],
        [-0.5788],
        [-0.0307],
        [-0.5433],
        [ 1.8394],
        [ 1.5345],
        [-1.2456],
        [ 1.4758],
        [-0.6931],
        [-0.4255],
        [-1.6586],
        [-1.8927],
        [-2.4480],
        [ 1.2915],
        [-0.9435],
        [ 1.2765],
        [ 2.1102],
        [ 0.5389],
        [-1.0335],
        [-0.4092],
        [ 2.4877],
        [-0.6785],
        [ 1.4000],
        [ 2.8632],
        [-1.2767],
        [ 2.1338],
        [ 2.0295],
        [-2.5879],
        [ 1.5307],
        [ 0.5633],
        [-2.3177],
        [-2.3904],
        [ 0.9247],
        [ 0.9997],
        [-0.9748],
        [ 1.6289],
        [-1.8652],
        [ 1.1255],
        [ 1.1884],
        [ 0.8256],
        [-2.9929],
        [-1.6941],
        [ 0.1240],
        [-1.8214],
        [-2.0618],
        [ 1.6897],
        [ 2.4352],
        [-1.5026],
        [-1.7474],
        [-1.0927],
        [ 1.8857],
        [-2.0621],
        [-2.8898],
        [ 1.0218],
        [-0.7071],
        [ 1.9784],
        [-2.0895],
        [-1.2611],
        [-2.5984],
        [-1.5333],
        [-0.9141],
        [-1.3535],
        [-0.8942],
        [ 0.9502],
        [-0.9510],
        [ 0.5320],
        [-0.4191],
        [ 2.8878],
        [ 2.6288],
        [-0.0248],
        [ 0.4885],
        [-1.4844],
        [-2.6564],
        [-2.3084],
        [ 1.7332],
        [-0.3756],
        [-0.1415],
        [-1.6732],
        [ 2.2608],
        [-1.3334],
        [ 1.4496],
        [-0.4967],
        [-0.5702],
        [ 1.0870],
        [-2.9134],
        [-2.4611],
        [ 0.0120],
        [ 2.2287],
        [ 1.3410],
        [ 0.1298],
        [ 0.0354],
        [ 0.4846],
        [-2.1992],
        [ 1.4453],
        [-0.5160],
        [-0.7917],
        [-2.8553],
        [ 0.0960],
        [-0.4223],
        [-1.1975],
        [ 1.2752],
        [ 0.8209],
        [ 1.5471],
        [-2.9569],
        [-1.5548],
        [ 1.2277],
        [-1.5609],
        [-1.8653],
        [ 1.6915],
        [ 0.5383],
        [ 1.0511],
        [ 2.1121],
        [-2.5858],
        [ 0.0305],
        [-2.0349],
        [ 1.8573],
        [ 2.4751],
        [ 1.7144],
        [-0.8604],
        [-0.4331],
        [ 0.8458],
        [-2.1901],
        [ 2.2386],
        [-2.9200],
        [-2.0335],
        [ 0.2847],
        [ 1.8138],
        [-1.7357],
        [-2.2415],
        [ 1.7967],
        [ 0.3946],
        [ 0.4404],
        [-0.6708],
        [ 1.1731],
        [-2.0249],
        [-2.1650],
        [-2.8104],
        [ 0.9589],
        [-0.6266],
        [ 2.6558],
        [-0.9143],
        [-2.6738],
        [ 0.7793],
        [ 0.9157],
        [ 2.1979],
        [ 1.6351],
        [ 1.3821],
        [-1.0854],
        [ 1.8009],
        [ 0.6957],
        [-2.5852],
        [-2.5447],
        [ 1.7044],
        [ 2.4365],
        [-0.6797],
        [ 1.5348],
        [-2.5976],
        [ 1.7702],
        [-1.5036],
        [-2.8194],
        [-2.3740],
        [ 2.9594],
        [-1.2646],
        [-0.6618],
        [-2.2782],
        [ 0.0799],
        [-1.5703],
        [ 1.6242],
        [-2.5314],
        [ 1.9060],
        [-0.7164],
        [ 1.7385],
        [ 0.1244],
        [ 0.0417],
        [ 0.0316],
        [ 2.8915],
        [-2.8528],
        [-2.5862],
        [-1.3970],
        [-1.6464],
        [ 1.2379],
        [ 0.7333],
        [-0.9952],
        [-2.3974],
        [-2.6192],
        [ 0.8640],
        [ 0.7642],
        [-0.0349],
        [-2.8604],
        [ 1.1887],
        [-2.8990],
        [ 0.6631],
        [ 1.3853],
        [ 0.3977],
        [ 1.8530],
        [ 2.7834],
        [-2.5563],
        [-2.1054],
        [ 2.9555],
        [ 0.7206],
        [-2.1835],
        [ 1.5419],
        [ 0.2845],
        [-2.3489],
        [ 0.8332],
        [ 2.6400],
        [-1.6336],
        [-0.5365],
        [ 0.1990],
        [ 2.1787],
        [ 2.1014],
        [ 2.0711],
        [-2.7049],
        [ 1.0319],
        [ 1.9224],
        [-1.6547],
        [ 2.6419],
        [-2.6029],
        [ 0.1846],
        [ 1.8240],
        [ 0.7899],
        [-2.5299],
        [ 0.2535],
        [ 2.8468],
        [ 1.8327],
        [ 1.2705],
        [ 2.1337],
        [-1.6239],
        [ 2.9859],
        [ 2.8455],
        [ 0.4544],
        [-0.0594],
        [ 1.1798],
        [ 0.8443],
        [ 0.8857],
        [-1.9486],
        [-2.0745],
        [ 2.6288],
        [-2.5341],
        [-1.7863],
        [ 0.2945],
        [ 0.1138],
        [-1.3424],
        [ 0.5925],
        [-1.0177],
        [-0.6897],
        [ 1.5342],
        [-1.7337],
        [ 1.7529],
        [-2.3063],
        [-2.0641],
        [-0.7151],
        [-0.6418],
        [-2.7792],
        [ 2.0849],
        [-2.8146],
        [-2.3202],
        [ 1.2519],
        [-0.0549],
        [-0.8762],
        [ 0.9284],
        [-1.3738],
        [-1.0007],
        [ 0.1204],
        [-1.3099],
        [ 2.0739],
        [-0.3314],
        [-1.4141],
        [-2.6271],
        [-0.8538],
        [-2.2178],
        [ 2.1273],
        [ 2.2909],
        [ 1.0442],
        [ 2.5297],
        [ 1.0917],
        [ 2.2706],
        [ 0.9180],
        [-1.5515],
        [-0.8800],
        [-1.2752],
        [-0.3295],
        [-2.8101],
        [ 1.6262],
        [-2.8927],
        [-2.9089],
        [-1.6599],
        [ 0.4092],
        [-2.0896],
        [ 0.5457],
        [-1.9951],
        [-2.0030],
        [-1.0623],
        [-0.3833],
        [-2.2951],
        [ 1.6595],
        [-2.4404],
        [ 2.4125],
        [ 1.2675],
        [ 1.0653],
        [ 1.6469],
        [-2.4702],
        [ 2.8786],
        [-0.8966],
        [ 0.4182],
        [ 1.5721],
        [ 2.1477],
        [ 1.0934],
        [-1.5712],
        [-0.6601],
        [ 0.6944],
        [ 2.5757],
        [ 2.0540],
        [ 2.4060],
        [ 2.3676],
        [-2.5238],
        [ 1.1647],
        [-1.2162],
        [ 0.0840],
        [ 1.6847],
        [-1.6722],
        [-2.3365],
        [-1.8013],
        [ 2.6588],
        [ 0.6091],
        [ 1.9678],
        [-1.8083],
        [ 2.4622],
        [-2.7599],
        [-2.3731],
        [ 1.8810],
        [ 2.1480],
        [ 0.7992],
        [ 0.1082],
        [ 2.5513],
        [ 1.7055],
        [-1.8041],
        [ 0.3371],
        [-1.6240],
        [-1.2597],
        [-1.0753],
        [ 1.6340],
        [ 1.6310],
        [-1.7934],
        [ 0.2980],
        [ 1.4387],
        [-0.2700],
        [ 2.0843],
        [-1.1844],
        [-2.9023],
        [ 0.9978],
        [-2.5435],
        [-0.8112],
        [ 1.2368],
        [-1.3315],
        [ 0.2994],
        [-0.4469],
        [-1.6151],
        [-1.2981],
        [ 2.0022],
        [-1.5437],
        [-1.7525],
        [-0.6396],
        [ 2.7906],
        [-1.5829],
        [ 0.6473],
        [-1.7220],
        [-0.9260],
        [-2.2140],
        [-2.0565],
        [-0.0555],
        [-2.6598],
        [ 1.8097],
        [-2.1425],
        [ 1.5010],
        [-1.4489],
        [-0.6328],
        [-0.3540],
        [-1.5999],
        [-2.9027],
        [ 2.9857],
        [-0.5053],
        [ 2.8777],
        [ 0.4541],
        [ 2.2903],
        [-0.0849],
        [ 0.0741],
        [-1.8847],
        [-2.6932],
        [-2.0102],
        [ 2.8136],
        [ 0.8549],
        [ 0.2819],
        [ 0.1362],
        [ 2.8655],
        [-0.0918],
        [ 2.1380],
        [-1.8382],
        [-0.9909],
        [ 0.5793],
        [ 0.2494],
        [-0.5094],
        [-0.6133],
        [ 0.6627],
        [ 1.4802],
        [-2.8072],
        [ 0.5161],
        [-0.3297],
        [-0.5667],
        [ 2.8817],
        [ 2.1692],
        [-0.6114],
        [-1.8258],
        [ 1.3014],
        [ 0.0274],
        [-1.8709],
        [-2.7010],
        [ 2.8338],
        [ 2.1691],
        [ 0.2948],
        [-2.8386],
        [-1.2402],
        [-2.0653],
        [ 2.8847],
        [ 1.5089],
        [ 0.8645],
        [-1.5514],
        [-1.0311],
        [ 1.1499],
        [ 2.8829],
        [ 0.6595],
        [-2.1889],
        [-2.1956],
        [ 0.6612],
        [-0.3018],
        [-0.2237],
        [ 1.1213],
        [-2.1998],
        [ 2.5347],
        [ 2.1441],
        [ 2.5783],
        [-2.8381],
        [ 0.4850],
        [-0.4066],
        [-0.6474],
        [ 2.7810],
        [ 2.6885],
        [ 2.3520],
        [ 1.7444],
        [-0.6857],
        [ 1.4558],
        [ 0.8187],
        [ 0.9471],
        [ 0.8505],
        [-2.6897],
        [ 1.8990],
        [ 0.4890],
        [-2.2828],
        [ 2.1106],
        [-1.6050],
        [ 1.6136],
        [-2.6110],
        [-2.2449],
        [ 2.8401],
        [ 0.3199],
        [ 1.2046],
        [-1.1007],
        [-0.0384],
        [-0.8879],
        [-2.0348],
        [ 0.3725],
        [-1.2939],
        [-0.8341],
        [-1.3831],
        [-2.4860],
        [ 1.2542],
        [-2.3827],
        [-1.9478],
        [-2.8797],
        [-1.6920],
        [ 2.6578],
        [ 0.2274],
        [-2.1724],
        [ 0.9304],
        [ 2.5512],
        [ 0.8483],
        [ 2.3209],
        [ 1.9420],
        [ 2.6722],
        [-2.6879],
        [-0.0521],
        [ 0.1919],
        [ 0.8504],
        [ 2.4542],
        [ 1.8111],
        [ 2.0021],
        [-2.0104],
        [-1.9664],
        [-1.3001],
        [ 0.0214],
        [-0.1091],
        [-0.8896],
        [-2.3633],
        [ 2.2840],
        [ 0.8779],
        [-2.0924],
        [-0.0579],
        [-2.6130],
        [-1.8808],
        [ 0.3731],
        [ 0.0090],
        [ 1.6047],
        [-0.2284],
        [-1.1745],
        [-2.8346],
        [ 2.9604],
        [ 2.8082],
        [ 2.6229],
        [-0.9186],
        [ 2.2664],
        [-0.4986],
        [ 0.2168],
        [-1.3044],
        [-2.8844],
        [ 0.8718],
        [ 1.1312],
        [ 2.0972],
        [ 0.1440],
        [-0.3523],
        [ 0.9184],
        [ 1.3228],
        [-0.7235],
        [-1.4517],
        [-1.1153],
        [-1.7377],
        [-0.5857],
        [ 2.6948],
        [ 1.8994],
        [-0.0907],
        [-2.6330],
        [-2.5713],
        [ 2.8848],
        [-2.8346],
        [-0.3514],
        [-2.8384],
        [ 0.8221],
        [-2.2012],
        [-1.3741],
        [ 0.7379],
        [ 1.1839],
        [-1.8126],
        [-0.6577],
        [ 0.7819],
        [ 2.1907],
        [ 2.1644],
        [-1.6038],
        [ 2.5328],
        [ 2.1201],
        [ 0.6169],
        [-2.8408],
        [ 2.5664],
        [ 2.6137],
        [-1.3447],
        [-2.4673],
        [ 1.1033],
        [ 1.9981],
        [ 0.3319],
        [ 0.1454],
        [ 0.9336],
        [-1.2309],
        [ 1.9154],
        [ 1.1985],
        [-0.7679],
        [-0.5484],
        [-0.6204],
        [-2.9508],
        [ 2.4033],
        [-1.7792],
        [ 0.5031],
        [ 0.3739],
        [-1.2886],
        [-1.3261],
        [ 0.3734],
        [ 0.1001],
        [ 1.8637],
        [ 2.0615],
        [-1.3955],
        [ 1.0902],
        [ 1.6627],
        [-0.1675],
        [ 0.5655],
        [-0.7391],
        [ 0.9841],
        [ 1.0907],
        [-1.1861],
        [ 1.8054],
        [ 0.9436],
        [ 0.5212],
        [-2.4057],
        [ 1.2141],
        [ 0.2662],
        [ 2.6963],
        [ 0.1515],
        [ 1.2234],
        [ 0.8569],
        [ 2.8912],
        [-1.0449],
        [-2.5906],
        [-0.9211],
        [-1.2090],
        [ 0.2647],
        [-0.1101],
        [ 0.3172],
        [ 0.6513],
        [ 1.4642],
        [ 0.1091],
        [-0.1617],
        [-0.8606],
        [-0.8488],
        [ 1.5612],
        [ 0.2362],
        [-0.5491],
        [-2.3727],
        [ 1.9097],
        [-0.7795],
        [-2.2791],
        [-0.5473],
        [ 1.7687],
        [-2.7444],
        [ 2.2171],
        [ 0.3471],
        [ 1.5178],
        [-0.7304],
        [ 2.2568],
        [ 2.5886],
        [-1.8826],
        [-2.4931],
        [-2.2800],
        [ 0.9045],
        [ 0.8870],
        [-2.3772],
        [ 0.0434],
        [ 2.3390],
        [-2.3531],
        [-0.2885],
        [ 0.8162],
        [-1.6555],
        [ 1.1717],
        [-0.4330],
        [ 0.7815],
        [-0.6712],
        [-1.3300],
        [ 0.3270],
        [-2.1565],
        [ 0.4779],
        [-0.6037],
        [ 1.9387],
        [ 2.0496],
        [-0.6888],
        [-2.7403],
        [ 2.7717],
        [ 2.6872],
        [-2.4739],
        [ 0.6245],
        [-2.6345],
        [ 0.9605],
        [ 0.7109],
        [ 0.0866],
        [ 1.3473],
        [ 0.5579],
        [-0.1436],
        [-2.2479],
        [-1.4362],
        [ 0.7445],
        [ 1.1254],
        [-1.6720],
        [ 1.9161],
        [-2.6496],
        [-0.7530],
        [-2.1153],
        [-1.3707],
        [ 1.6096],
        [-1.9304],
        [-0.6668],
        [ 1.1658],
        [ 2.1634],
        [-0.4964],
        [-0.4525],
        [-2.6776],
        [-1.8107],
        [ 2.2775],
        [-0.8388],
        [ 2.3735],
        [ 1.1490],
        [ 1.2155],
        [-2.5570],
        [ 1.6989],
        [ 1.9645],
        [-0.1426],
        [-0.2785],
        [-1.8351],
        [-2.4031],
        [ 1.0153],
        [-0.7640],
        [-0.3578],
        [-1.5187],
        [-2.8366],
        [ 2.9289],
        [-1.0901],
        [-2.6689],
        [-2.3734],
        [ 0.4101],
        [ 0.0070],
        [ 1.5863],
        [ 2.5068],
        [-2.9585],
        [-2.1442],
        [ 0.3130],
        [ 2.4456],
        [-1.5881],
        [ 0.8484],
        [ 1.1843],
        [ 1.7207],
        [ 1.0554],
        [-0.2032],
        [ 0.1934],
        [-2.1182],
        [ 1.8771],
        [-1.3491],
        [ 1.4881],
        [ 1.8683],
        [-2.2332],
        [ 1.7167],
        [ 1.1367],
        [-2.6748],
        [ 0.9508],
        [ 1.3261],
        [ 1.7926],
        [ 0.1102],
        [-1.7147],
        [-0.8330],
        [-2.4850],
        [ 0.9725],
        [-0.2748],
        [ 2.8120],
        [ 2.5845],
        [ 2.4519],
        [-2.8184],
        [ 0.8224],
        [-2.7806],
        [ 0.1677],
        [ 2.2580],
        [ 0.8974],
        [-1.5479],
        [-2.6493],
        [-0.5598],
        [ 0.3874],
        [ 1.7362],
        [-2.9915],
        [-0.4477],
        [ 2.1480],
        [ 1.1499],
        [-2.1762],
        [ 0.9229],
        [-0.6866],
        [-0.7230],
        [ 1.4323],
        [ 0.8190],
        [ 1.0003],
        [ 0.7391],
        [-2.8654],
        [-0.0289],
        [-2.1061],
        [ 2.1351],
        [ 1.9524],
        [-0.7776],
        [ 2.1927],
        [ 2.1773],
        [ 0.3619],
        [-2.7402],
        [-2.3475],
        [-0.5835],
        [-2.5345],
        [ 2.1682],
        [ 0.5995],
        [ 0.5022],
        [-0.8586],
        [ 1.8138],
        [-1.4352],
        [ 0.2965],
        [ 2.1220],
        [ 0.1734],
        [-1.5525],
        [-0.0979],
        [-0.4411],
        [ 1.6686],
        [ 0.7863],
        [ 0.8542],
        [ 0.8728],
        [-2.7285],
        [ 1.6965],
        [ 1.5099],
        [-0.0446],
        [-0.7574],
        [ 1.3578],
        [ 0.7321],
        [ 2.4536],
        [-2.1610],
        [-0.6216],
        [ 0.7242],
        [-1.4529],
        [ 1.9729],
        [ 0.4829],
        [ 0.9688],
        [-2.4176],
        [ 1.7469],
        [-0.1580],
        [-1.4178],
        [ 1.1776],
        [-1.7382],
        [ 2.5298],
        [-0.6004],
        [ 1.3365],
        [-0.1354],
        [-2.7411],
        [ 1.1680],
        [ 1.7651],
        [ 0.7967],
        [ 1.3850],
        [-2.4334],
        [-0.6234],
        [-2.4947],
        [ 0.0399],
        [-2.1495],
        [-0.5476],
        [-0.0962],
        [-2.2158],
        [ 2.0093],
        [-0.9126],
        [-0.5234],
        [-0.6806],
        [ 2.2695],
        [ 1.1303],
        [ 1.9968],
        [ 0.3229],
        [ 2.7070],
        [ 0.4254],
        [ 0.6550],
        [ 0.6488],
        [ 0.8838],
        [-0.6868],
        [-1.9944],
        [-2.9486],
        [-0.3718],
        [-2.8726],
        [ 0.6398],
        [ 0.8559],
        [ 1.9547],
        [-2.5444],
        [ 0.1748],
        [ 1.1818],
        [-1.5596],
        [ 0.5876],
        [ 0.6669],
        [ 1.9922],
        [-2.6583],
        [ 1.3756],
        [-0.4164],
        [-2.6407],
        [ 1.3385],
        [ 0.2054],
        [ 0.5708],
        [ 1.7760],
        [-2.7404],
        [-2.5737],
        [ 1.4506],
        [ 0.7807],
        [-0.0271],
        [ 2.2591],
        [-0.0645],
        [ 2.4320],
        [ 2.4727],
        [-2.0695],
        [-1.5706],
        [-1.7648],
        [ 0.3722],
        [-1.9886],
        [-2.5949],
        [-1.8126],
        [-0.3370],
        [ 2.6930],
        [ 0.2980],
        [-2.6009],
        [ 1.0111],
        [-2.6299],
        [ 2.8278],
        [-2.6989]])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])