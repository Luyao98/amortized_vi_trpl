Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 168, in <module>
    train_model(model, target, n_epochs, batch_size, n_context, n_components, eps, beta, alpha, optimizer, device)
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 106, in train_model
    loss += proj_loss_j
RuntimeError: a leaf Variable that requires grad is being used in an in-place operation.
tensor([[-1.9896],
        [ 0.1587],
        [-0.1145],
        [ 0.3666],
        [ 2.3412],
        [ 2.9813],
        [ 0.5449],
        [ 0.3547],
        [ 1.7104],
        [ 0.7107],
        [ 2.9677],
        [ 1.3367],
        [ 0.2791],
        [-0.5767],
        [ 0.9728],
        [ 2.1902],
        [-0.2410],
        [-0.2871],
        [ 2.0705],
        [-2.8818],
        [ 1.6486],
        [-2.9875],
        [ 1.1627],
        [ 0.6215],
        [ 1.7697],
        [-0.9377],
        [-2.0066],
        [ 1.0560],
        [-0.9411],
        [-0.3095],
        [ 2.5094],
        [-0.0689],
        [-0.3425],
        [-1.6140],
        [-2.3516],
        [ 2.5595],
        [ 1.5939],
        [-0.5737],
        [ 2.8039],
        [ 2.5518],
        [-1.4056],
        [-0.1721],
        [ 1.3584],
        [-1.3015],
        [ 1.2448],
        [-0.8885],
        [-1.5453],
        [-0.0248],
        [-2.8590],
        [-0.8714],
        [ 0.9278],
        [ 2.1647],
        [ 2.6927],
        [-1.4662],
        [ 1.2128],
        [-2.1265],
        [-0.8032],
        [-0.6698],
        [-2.2504],
        [ 0.1608],
        [ 0.9067],
        [-2.2250],
        [-0.7043],
        [ 0.2499],
        [ 0.0230],
        [-2.0929],
        [ 0.6808],
        [ 1.0234],
        [ 0.1781],
        [-2.8540],
        [-0.9445],
        [ 2.5290],
        [ 0.4542],
        [-0.0866],
        [-2.8141],
        [ 0.4511],
        [-1.6782],
        [-0.2128],
        [-0.3335],
        [-1.0764],
        [-2.6502],
        [-0.3521],
        [-1.9611],
        [-0.6488],
        [ 2.7795],
        [-0.6935],
        [-1.3210],
        [ 2.5488],
        [ 1.4004],
        [ 2.5785],
        [-0.6208],
        [ 2.4521],
        [-0.7135],
        [-2.7317],
        [-0.6242],
        [-0.8352],
        [ 0.8823],
        [ 1.6342],
        [-1.0112],
        [ 0.7744],
        [-0.7970],
        [-1.1627],
        [ 2.4785],
        [ 1.0536],
        [ 1.1783],
        [ 1.3806],
        [ 0.9139],
        [ 0.9770],
        [-0.5732],
        [ 1.2004],
        [ 1.0508],
        [-2.4722],
        [ 1.9115],
        [-0.7898],
        [ 2.4263],
        [ 0.7303],
        [-1.7024],
        [ 1.6384],
        [-2.1272],
        [-1.7363],
        [-2.7468],
        [-1.2613],
        [-1.4835],
        [-2.6321],
        [ 0.8081],
        [ 1.1282],
        [ 2.9854],
        [-1.9857],
        [ 0.4456],
        [ 2.7460],
        [ 1.2761],
        [ 0.6908],
        [-0.2413],
        [ 2.0842],
        [ 0.1777],
        [-1.0607],
        [-2.2718],
        [ 0.5570],
        [-0.4102],
        [ 0.8004],
        [-2.6621],
        [ 2.2365],
        [ 0.3455],
        [ 2.1013],
        [-2.0099],
        [ 0.0313],
        [ 0.4730],
        [-1.9802],
        [ 0.0255],
        [ 0.9536],
        [-2.5344],
        [-0.3804],
        [ 0.9765],
        [ 0.1138],
        [-2.8201],
        [-0.3363],
        [ 0.3300],
        [ 0.2087],
        [ 0.9106],
        [ 1.3004],
        [-1.5466],
        [ 0.3075],
        [ 2.0879],
        [ 1.9384],
        [-2.7919],
        [ 1.8162],
        [-1.0322],
        [ 1.8354],
        [-2.6865],
        [ 2.1971],
        [-2.7627],
        [-0.5835],
        [ 1.2163],
        [ 2.8773],
        [ 2.2845],
        [ 1.0095],
        [ 2.0214],
        [ 2.6030],
        [-0.9124],
        [-2.3912],
        [-0.5036],
        [ 2.6223],
        [ 0.2313],
        [ 2.1915],
        [ 1.7797],
        [-2.1356],
        [ 0.9222],
        [ 0.0635],
        [ 2.4803],
        [-0.6849],
        [ 0.4608],
        [ 2.8683],
        [ 1.6500],
        [-0.3183],
        [-0.5065],
        [ 0.9405],
        [-0.2256],
        [-1.4155],
        [ 0.6897],
        [-2.0471],
        [ 0.0276],
        [-1.5508],
        [ 2.5505],
        [-1.9751],
        [-0.1869],
        [-2.6966],
        [ 0.0855],
        [-2.3400],
        [-1.6172],
        [ 2.5174],
        [ 0.8798],
        [ 1.2985],
        [ 0.3910],
        [ 1.3335],
        [ 2.2785],
        [-1.3266],
        [ 1.9074],
        [-1.8485],
        [ 0.6013],
        [ 0.7721],
        [ 0.1417],
        [-1.0444],
        [-2.8347],
        [ 0.9102],
        [ 2.7114],
        [ 0.7530],
        [ 0.9023],
        [-1.2824],
        [-2.9518],
        [-1.9926],
        [-2.8834],
        [-0.8809],
        [-0.5658],
        [-2.6123],
        [ 1.5867],
        [ 2.6962],
        [ 2.5339],
        [-0.7389],
        [-1.8768],
        [ 2.7627],
        [-1.4964],
        [-1.1654],
        [ 1.0297],
        [-0.5626],
        [ 0.3392],
        [ 2.5068],
        [-2.2943],
        [-2.2126],
        [ 0.0479],
        [ 1.2859],
        [-2.6968],
        [-2.5800],
        [-0.0565],
        [-1.2971],
        [-1.9561],
        [ 2.6639],
        [-0.7610],
        [-0.4335],
        [ 0.7190],
        [-0.9446],
        [-2.1837],
        [ 1.1621],
        [ 1.3646],
        [ 2.0132],
        [ 0.7899],
        [-2.0568],
        [-1.3049],
        [-0.0921],
        [ 2.6866],
        [ 0.0982],
        [ 0.5514],
        [ 0.6235],
        [ 1.6919],
        [ 2.8938],
        [ 1.4128],
        [-2.4995],
        [ 2.6558],
        [ 2.7415],
        [ 1.5346],
        [-0.3195],
        [-1.9750],
        [-2.2508],
        [-2.8664],
        [-1.1754],
        [ 2.9928],
        [-0.4462],
        [-0.8068],
        [ 2.6391],
        [ 2.5427],
        [ 2.3559],
        [-2.5662],
        [ 2.7194],
        [ 1.0028],
        [ 2.0267],
        [ 1.1261],
        [-2.4322],
        [-1.5352],
        [-2.3021],
        [ 0.6349],
        [-2.4667],
        [ 0.7634],
        [-0.0405],
        [-1.6215],
        [ 1.0939],
        [-1.7173],
        [ 2.9819],
        [-1.1294],
        [-0.9337],
        [ 0.3040],
        [-2.8060],
        [ 0.1585],
        [-1.7295],
        [ 2.9483],
        [ 1.2087],
        [ 0.8225],
        [ 0.4760],
        [ 2.9247],
        [-2.7464],
        [-1.9262],
        [ 1.6940],
        [ 1.2226],
        [-2.2869],
        [ 1.3784],
        [ 0.9977],
        [-1.8236],
        [ 2.8270],
        [-0.1196],
        [-0.6770],
        [ 1.6589],
        [ 1.4411],
        [-2.7530],
        [-2.1707],
        [-0.6304],
        [-2.6824],
        [-0.0303],
        [ 0.5067],
        [ 0.6518],
        [-2.1423],
        [-0.9673],
        [-0.8671],
        [-1.9653],
        [-2.5771],
        [ 2.6207],
        [ 0.0986],
        [ 1.6372],
        [ 1.6166],
        [ 1.3903],
        [-0.3740],
        [-1.1461],
        [ 0.1406],
        [-2.8105],
        [ 2.2544],
        [ 1.3228],
        [-2.7368],
        [-0.4525],
        [-1.6477],
        [ 2.7567],
        [-2.9618],
        [ 2.3980],
        [-0.9273],
        [ 0.0060],
        [-1.2458],
        [ 0.0093],
        [-1.7970],
        [ 0.7680],
        [-1.8317],
        [ 0.1241],
        [-0.9434],
        [-2.0241],
        [-1.8698],
        [ 0.2597],
        [ 0.5977],
        [ 2.9691],
        [ 1.1482],
        [ 0.5973],
        [ 2.7901],
        [-2.6687],
        [ 0.1369],
        [-2.5764],
        [-0.9599],
        [ 1.9370],
        [ 0.3852],
        [-2.7229],
        [ 2.7306],
        [-2.3349],
        [ 0.3302],
        [-1.1072],
        [ 0.2593],
        [-0.2778],
        [-2.4058],
        [-1.4116],
        [-1.9629],
        [-2.5848],
        [ 1.8914],
        [ 2.5580],
        [ 0.5380],
        [ 1.6636],
        [-0.1283],
        [-2.4282],
        [ 2.4675],
        [ 0.5755],
        [ 1.0982],
        [ 0.7683],
        [-1.9215],
        [ 0.2397],
        [-0.0788],
        [ 2.4178],
        [-2.8863],
        [ 2.6553],
        [ 2.9347],
        [ 1.5010],
        [-0.2445],
        [ 1.8858],
        [-0.0146],
        [ 0.7603],
        [ 2.5806],
        [-1.0801],
        [ 1.6196],
        [ 2.8441],
        [-0.2064],
        [ 2.7054],
        [ 0.1155],
        [-1.3082],
        [ 0.6057],
        [ 0.6418],
        [ 2.8572],
        [-2.1546],
        [ 2.6307],
        [-0.7846],
        [ 2.5172],
        [ 0.4649],
        [ 1.9397],
        [-0.0398],
        [-1.8246],
        [-2.8081],
        [-2.9084],
        [-0.8589],
        [-0.9082],
        [-1.4994],
        [-2.3403],
        [-2.2578],
        [-0.2746],
        [-2.3424],
        [ 0.7726],
        [ 2.4876],
        [ 0.4137],
        [ 2.3333],
        [-2.3822],
        [-2.5872],
        [ 2.2720],
        [ 2.8771],
        [ 0.8040],
        [-1.5608],
        [ 1.8648],
        [-2.2853],
        [-0.4787],
        [ 1.2073],
        [-0.5606],
        [ 1.3373],
        [ 1.0670],
        [-0.7097],
        [-1.0612],
        [-0.2354],
        [-2.8351],
        [ 2.3628],
        [-0.2187],
        [ 1.0795],
        [-1.4383],
        [-0.4157],
        [-1.2705],
        [ 0.1054],
        [ 1.3727],
        [-1.2499],
        [-0.0148],
        [-2.9660],
        [ 0.0983],
        [-2.1495],
        [-0.7197],
        [-0.5078],
        [-0.3422],
        [-0.0370],
        [-2.1805],
        [ 2.3165],
        [-1.9515],
        [-1.1713],
        [ 2.7935],
        [ 0.2835],
        [-1.4084],
        [ 0.7934],
        [-0.6365],
        [-1.1256],
        [-0.7385],
        [ 0.2995],
        [ 0.1798],
        [ 2.8091],
        [-0.6023],
        [ 0.0216],
        [-0.4390],
        [ 0.6890],
        [ 1.9667],
        [-2.3332],
        [ 2.2883],
        [ 0.1204],
        [-2.9539],
        [ 1.9262],
        [-0.8199],
        [-1.2266],
        [-2.9954],
        [ 1.9295],
        [-1.8207],
        [-2.8078],
        [-1.5332],
        [ 1.6085],
        [ 1.6031],
        [-2.7950],
        [-0.0612],
        [ 0.9646],
        [-2.5123],
        [ 2.4394],
        [ 1.9123],
        [-0.2669],
        [ 2.8124],
        [ 1.9783],
        [ 0.6178],
        [-1.2161],
        [ 1.0417],
        [-2.7475],
        [-2.4721],
        [ 0.2136],
        [-2.7328],
        [ 2.7121],
        [-2.3422],
        [ 1.8353],
        [-2.0724],
        [ 2.8152],
        [-1.2487],
        [ 0.6329],
        [ 2.7481],
        [-2.1235],
        [-2.0879],
        [-1.4523],
        [-2.5384],
        [-1.7724],
        [-1.1835],
        [ 1.6239],
        [ 2.3198],
        [ 2.6963],
        [ 2.7682],
        [-2.0941],
        [ 2.6935],
        [ 1.6454],
        [ 2.7329],
        [-2.9259],
        [ 0.0806],
        [ 1.5101],
        [-2.5046],
        [-1.8451],
        [-2.6338],
        [-2.7707],
        [ 2.3707],
        [-2.9463],
        [ 2.7410],
        [-0.6521],
        [ 0.5328],
        [ 2.8767],
        [ 0.7282],
        [ 1.0027],
        [-1.9553],
        [-0.7507],
        [ 1.5908],
        [-1.4999],
        [ 1.1134],
        [ 1.7415],
        [-1.3518],
        [-0.6577],
        [-1.6785],
        [-1.6495],
        [ 0.6852],
        [ 1.2858],
        [ 1.2299],
        [ 1.5393],
        [ 0.5264],
        [-1.4675],
        [-2.6350],
        [-2.1938],
        [-1.2707],
        [-1.4722],
        [ 2.2182],
        [-1.2877],
        [ 1.4419],
        [ 0.6404],
        [ 2.6488],
        [ 0.3074],
        [-1.9103],
        [-1.3971],
        [ 2.5903],
        [ 2.1377],
        [ 0.7595],
        [-0.6890],
        [ 2.5768],
        [-1.9465],
        [-0.0057],
        [-2.0829],
        [ 2.5781],
        [ 0.7475],
        [ 2.0243],
        [ 2.9327],
        [-1.4473],
        [ 2.7235],
        [ 0.5362],
        [-2.8263],
        [-2.1070],
        [ 2.5794],
        [ 2.4204],
        [ 1.8579],
        [-1.4847],
        [ 1.4167],
        [ 0.0735],
        [-0.6915],
        [ 2.7231],
        [-0.4304],
        [ 2.5063],
        [ 0.1308],
        [ 0.1254],
        [-0.2543],
        [ 0.1914],
        [ 0.2187],
        [-2.9907],
        [ 2.0266],
        [-0.2514],
        [ 0.4396],
        [-0.3422],
        [ 0.7028],
        [ 1.8048],
        [ 1.8333],
        [ 0.2346],
        [-0.7447],
        [-2.8187],
        [-0.4597],
        [ 0.3273],
        [ 2.6628],
        [-2.4189],
        [ 1.2131],
        [-2.3771],
        [ 1.6007],
        [ 1.8817],
        [ 0.1619],
        [-0.2415],
        [ 1.1295],
        [ 1.6282],
        [-1.1380],
        [ 1.9520],
        [-2.1073],
        [-1.3546],
        [ 0.8835],
        [ 1.4383],
        [ 1.4029],
        [ 1.0563],
        [-1.6816],
        [-0.6542],
        [-2.3883],
        [-2.1537],
        [-2.5114],
        [-1.9723],
        [-1.8869],
        [ 1.2472],
        [-1.1146],
        [-0.8298],
        [-0.4923],
        [-2.1444],
        [-1.5973],
        [ 1.2561],
        [ 1.1135],
        [-0.7076],
        [-0.1270],
        [-1.0578],
        [ 2.0201],
        [ 0.8865],
        [ 0.4386],
        [-1.2207],
        [ 1.4282],
        [-1.7196],
        [-1.6067],
        [-0.9438],
        [ 1.7786],
        [-2.7330],
        [ 2.3992],
        [ 2.3743],
        [ 2.0545],
        [ 1.5961],
        [ 2.9150],
        [ 1.9391],
        [ 2.3505],
        [-1.7458],
        [-2.3607],
        [-1.1405],
        [ 1.7035],
        [-2.2556],
        [-1.1299],
        [ 2.3095],
        [-2.9080],
        [ 2.8496],
        [ 2.4557],
        [-2.0319],
        [-0.1900],
        [-2.4516],
        [ 1.2236],
        [-1.6613],
        [-0.6977],
        [ 1.0521],
        [ 0.2528],
        [-1.7214],
        [-0.1542],
        [ 2.1080],
        [ 0.3721],
        [ 2.3533],
        [ 0.5656],
        [-2.4260],
        [-0.0298],
        [ 1.8113],
        [-1.2021],
        [ 1.6194],
        [-1.0003],
        [ 0.4577],
        [-0.9676],
        [ 1.0591],
        [-0.8959],
        [-1.1777],
        [ 0.4385],
        [-1.1995],
        [-2.5382],
        [ 2.1170],
        [ 1.5152],
        [-2.4072],
        [ 1.2523],
        [-2.7790],
        [ 1.6515],
        [-1.8787],
        [-0.3080],
        [ 0.1641],
        [-2.9032],
        [-0.0499],
        [-1.0628],
        [ 0.5356],
        [ 2.3820],
        [-0.2528],
        [ 0.9619],
        [ 1.6970],
        [-1.6343],
        [ 0.6344],
        [ 2.4852],
        [ 0.2964],
        [-1.7961],
        [-0.2484],
        [-2.5513],
        [ 1.4249],
        [ 2.0388],
        [-0.7143],
        [ 0.1844],
        [ 2.9319],
        [ 1.6351],
        [-2.9772],
        [-2.5224],
        [-1.9373],
        [-2.4651],
        [-0.0973],
        [-1.7594],
        [ 1.2010],
        [-1.4873],
        [-2.5109],
        [ 1.2288],
        [-0.3678],
        [ 0.1382],
        [ 1.9494],
        [ 1.1885],
        [-0.7677],
        [-0.6733],
        [ 0.1102],
        [ 2.8142],
        [-1.6354],
        [-1.9359],
        [-2.4110],
        [-2.0397],
        [-0.1932],
        [-1.9739],
        [ 1.6340],
        [ 0.4686],
        [ 1.3934],
        [-0.0397],
        [ 1.5379],
        [-0.0404],
        [-2.1866],
        [-2.0045],
        [-1.3959],
        [-2.3435],
        [-2.3064],
        [ 2.8405],
        [ 0.3718],
        [-0.3349],
        [ 1.0164],
        [-1.5271],
        [ 0.0307],
        [-1.3620],
        [-2.2262],
        [-0.1484],
        [-1.5904],
        [-1.0769],
        [-1.8756],
        [ 2.0290],
        [-0.6307],
        [ 1.1822],
        [ 2.4554],
        [ 2.4691],
        [-1.4784],
        [-2.1673],
        [ 0.3816],
        [-1.1413],
        [ 1.5786],
        [-1.5537],
        [ 0.5858],
        [ 0.4362],
        [ 0.0504],
        [-1.2698],
        [ 0.2046],
        [-2.0722],
        [-2.0329],
        [-2.7314],
        [ 1.7989],
        [ 2.1619],
        [ 0.9411],
        [ 0.4857],
        [ 2.5096],
        [ 1.4221],
        [-2.1514],
        [-2.9845],
        [ 2.7159],
        [-1.7566],
        [-2.9159],
        [-0.7124],
        [ 1.7507],
        [-0.0928],
        [-0.9506],
        [ 1.7982],
        [-1.0891],
        [ 0.6946],
        [-1.2680],
        [ 1.0914],
        [ 2.2744],
        [-0.8333],
        [ 0.6765],
        [-2.4671],
        [-2.1989],
        [ 1.3906],
        [-1.0728],
        [-2.2165],
        [ 0.6271],
        [ 0.1714],
        [-1.0633],
        [ 0.9291],
        [-0.3077],
        [-0.4531],
        [ 0.3803],
        [-1.0126],
        [ 0.6513],
        [-1.0390],
        [-2.1158],
        [-1.0761],
        [-0.3240],
        [-1.1182],
        [-1.1536],
        [-1.2352],
        [-2.9095],
        [-1.5481],
        [ 0.9460],
        [-2.2409],
        [-0.7769],
        [-1.2395],
        [ 2.6896],
        [-0.7562],
        [ 2.8635],
        [-0.4921],
        [-0.0130],
        [-2.1529],
        [-1.0050],
        [ 1.2715],
        [-1.7023],
        [ 0.4279],
        [ 1.6592],
        [ 1.7262],
        [-0.0535],
        [-1.2591],
        [-1.2383],
        [ 2.4405],
        [ 2.6067],
        [-1.6424],
        [-2.0086],
        [-2.6692],
        [-1.7062],
        [-0.3459],
        [ 2.0132],
        [ 1.7630],
        [ 2.4323],
        [ 2.6228],
        [ 2.1023],
        [ 2.0420],
        [-0.6196],
        [ 1.1966],
        [-2.8963],
        [ 0.5326],
        [ 1.6669],
        [ 0.6481],
        [ 0.3415],
        [-0.3543],
        [ 2.4824],
        [ 0.6299],
        [-1.4546],
        [-0.4460],
        [-0.0234],
        [-0.2863],
        [-1.9826],
        [ 2.1799],
        [-0.2816],
        [ 0.7415],
        [-0.6813],
        [ 0.5635],
        [-1.4709],
        [-0.3842],
        [ 2.4476],
        [ 2.4425],
        [ 1.7068],
        [-2.5330],
        [-1.5987],
        [-1.5671],
        [ 1.8757],
        [-2.7390],
        [ 2.6691],
        [-1.1614],
        [-0.3529],
        [ 1.2290],
        [-0.4890],
        [-2.3527],
        [-0.1070],
        [-1.8363],
        [-0.9046],
        [-1.5311],
        [-0.3074],
        [-0.9474],
        [-0.2458],
        [ 2.4699],
        [ 1.2546],
        [-0.5935],
        [-1.8220],
        [-0.3788],
        [ 2.0073],
        [ 0.8499],
        [-0.0892],
        [-0.6032],
        [ 0.4886],
        [-1.9419],
        [-0.8193]])
torch.Size([64])
torch.Size([64])
torch.Size([64])