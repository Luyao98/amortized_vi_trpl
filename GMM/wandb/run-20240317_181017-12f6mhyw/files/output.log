tensor([[ 1.1699],
        [-1.8861],
        [-1.2168],
        [ 2.7813],
        [-1.6711],
        [ 1.5538],
        [ 1.2537],
        [ 2.4803],
        [ 2.1489],
        [-1.9356],
        [-1.0632],
        [-0.3481],
        [ 1.0281],
        [-2.6336],
        [ 0.9747],
        [-2.9287],
        [ 2.7514],
        [-0.2472],
        [-0.2860],
        [ 1.0130],
        [-1.1970],
        [-2.6839],
        [-1.7696],
        [ 2.7545],
        [ 1.3605],
        [ 1.7033],
        [-2.9456],
        [-0.3187],
        [-0.3555],
        [ 2.0190],
        [ 2.2107],
        [ 2.5992],
        [ 2.3484],
        [ 2.0008],
        [ 0.2502],
        [ 1.9818],
        [-0.8267],
        [ 0.5879],
        [ 1.3258],
        [ 0.0818],
        [-0.9432],
        [-2.9839],
        [ 0.4833],
        [-0.3006],
        [ 0.3910],
        [-2.8265],
        [ 2.8762],
        [ 0.0578],
        [-0.0558],
        [ 2.3087],
        [-0.8760],
        [-1.1494],
        [-1.2351],
        [-0.1951],
        [-1.3287],
        [-1.9764],
        [ 0.3645],
        [-2.2424],
        [-1.3336],
        [-1.2683],
        [-1.1152],
        [-2.2679],
        [ 1.5942],
        [ 2.3271],
        [-0.0614],
        [ 1.3263],
        [-2.7903],
        [ 0.8371],
        [ 1.6911],
        [-0.1617],
        [ 1.2232],
        [ 0.7900],
        [ 0.1917],
        [-2.2129],
        [-1.1809],
        [-1.3268],
        [ 2.2669],
        [-0.9662],
        [-1.6467],
        [-0.8100],
        [ 1.0336],
        [ 1.2398],
        [-1.1744],
        [-0.7755],
        [-0.8275],
        [ 1.7129],
        [ 0.5125],
        [-0.6268],
        [ 1.2263],
        [-2.5763],
        [-2.0101],
        [-2.4391],
        [ 0.5810],
        [ 2.5208],
        [ 1.2585],
        [ 0.1623],
        [ 1.5411],
        [-1.6309],
        [ 1.1007],
        [ 2.3320],
        [-0.9905],
        [ 1.0716],
        [ 1.7931],
        [ 1.7192],
        [ 2.4727],
        [-2.0680],
        [ 0.3507],
        [ 1.6111],
        [ 0.2240],
        [-2.5646],
        [ 0.5306],
        [ 0.3418],
        [ 1.0071],
        [ 1.8697],
        [-1.0064],
        [ 0.1376],
        [-2.2499],
        [ 0.7462],
        [-1.7498],
        [-0.8202],
        [-1.4608],
        [-2.5221],
        [-0.2338],
        [ 2.0436],
        [ 0.9759],
        [-2.0765],
        [ 0.7941],
        [ 2.9340],
        [ 1.5262],
        [-1.0489],
        [ 2.5323],
        [ 1.9267],
        [ 1.3909],
        [-2.4495],
        [ 0.5472],
        [ 1.6588],
        [-0.9264],
        [ 2.5075],
        [-2.6517],
        [-1.3341],
        [ 1.0754],
        [ 2.0622],
        [ 2.5765],
        [ 1.9200],
        [ 2.9238],
        [ 2.8318],
        [ 1.6032],
        [-0.2388],
        [-2.3817],
        [ 1.5483],
        [ 2.5802],
        [-2.6570],
        [ 2.1651],
        [-1.1981],
        [ 2.8139],
        [-2.8784],
        [ 0.4052],
        [-1.0830],
        [ 2.2006],
        [ 0.4290],
        [ 0.6122],
        [-1.0931],
        [ 0.3261],
        [-1.8205],
        [-0.4719],
        [ 1.5188],
        [-1.4317],
        [-2.7837],
        [ 0.8166],
        [-0.1851],
        [ 2.8738],
        [-1.0915],
        [ 0.7856],
        [-1.0634],
        [-1.7081],
        [ 0.6722],
        [-2.2629],
        [-1.0759],
        [ 1.5146],
        [ 1.5508],
        [ 2.8441],
        [ 0.4668],
        [ 0.0852],
        [-0.3077],
        [-0.7087],
        [-0.3117],
        [ 0.8928],
        [-2.2073],
        [-1.6445],
        [-2.4704],
        [ 0.9222],
        [ 2.7215],
        [ 2.7760],
        [-0.9386],
        [ 0.0867],
        [ 2.3129],
        [-2.0791],
        [ 1.6355],
        [ 2.1613],
        [-0.9864],
        [-1.2912],
        [-2.8433],
        [ 1.7135],
        [ 0.9026],
        [-0.8095],
        [-2.6346],
        [-0.2276],
        [-0.6746],
        [-1.6209],
        [ 2.6276],
        [-0.2251],
        [-1.3271],
        [-2.8803],
        [-2.0344],
        [ 1.5644],
        [-1.5547],
        [-1.2073],
        [-1.4162],
        [-0.7162],
        [ 1.8471],
        [-0.7134],
        [ 0.6353],
        [-0.5331],
        [ 0.5807],
        [-1.2601],
        [ 0.5278],
        [ 0.3276],
        [-2.3306],
        [ 1.0041],
        [-1.4500],
        [-1.4654],
        [-0.9362],
        [-2.1634],
        [ 2.8380],
        [-2.1494],
        [-1.6282],
        [-0.9675],
        [ 1.7079],
        [-1.2793],
        [-1.4317],
        [ 1.0727],
        [-2.4008],
        [-2.1217],
        [ 1.1132],
        [-1.7965],
        [-2.0219],
        [ 0.8271],
        [-0.5030],
        [-2.4658],
        [-0.1177],
        [-2.2583],
        [ 2.6264],
        [ 2.6059],
        [-0.6220],
        [ 2.2882],
        [ 2.5841],
        [ 1.4162],
        [-1.0205],
        [ 1.0669],
        [ 2.1963],
        [-2.5548],
        [-2.8065],
        [ 2.0756],
        [-1.4496],
        [-0.9569],
        [-1.9045],
        [-1.9410],
        [ 0.3848],
        [-2.0389],
        [ 1.3459],
        [ 1.0018],
        [ 2.2168],
        [-2.7354],
        [ 2.0538],
        [-0.5069],
        [ 2.8975],
        [-1.4350],
        [ 1.6659],
        [-2.8262],
        [-0.9935],
        [-0.8793],
        [ 2.0126],
        [ 0.2208],
        [ 1.8551],
        [ 2.0892],
        [-0.4008],
        [ 0.9253],
        [ 2.0967],
        [-1.1223],
        [ 1.0358],
        [-0.7802],
        [-1.0574],
        [-1.0334],
        [-0.3925],
        [-0.9753],
        [-2.8279],
        [ 0.3741],
        [ 1.8466],
        [-1.5854],
        [-1.3407],
        [-0.3000],
        [ 1.3391],
        [ 2.0546],
        [ 0.0324],
        [-2.1079],
        [-1.5114],
        [ 0.1058],
        [-0.4382],
        [-0.1990],
        [-1.2018],
        [ 2.5404],
        [-0.3138],
        [-2.5112],
        [ 0.9148],
        [ 0.4970],
        [ 0.2166],
        [-2.1224],
        [ 2.3179],
        [ 1.3193],
        [-2.4406],
        [-0.0357],
        [ 0.8636],
        [ 2.6859],
        [-1.4464],
        [ 0.1461],
        [-1.3885],
        [ 1.3516],
        [ 1.3864],
        [ 2.0908],
        [-2.5924],
        [-1.6864],
        [ 2.6556],
        [-2.2044],
        [-1.3989],
        [-0.0842],
        [ 0.2275],
        [-2.8051],
        [-2.3551],
        [-2.9048],
        [-2.2253],
        [-2.5806],
        [ 0.6467],
        [-1.1529],
        [-0.4727],
        [ 1.3332],
        [ 2.2642],
        [ 0.3958],
        [-2.1672],
        [ 1.2089],
        [-2.6487],
        [ 1.1957],
        [ 1.7325],
        [-0.2445],
        [ 1.6368],
        [-0.0793],
        [ 0.2686],
        [ 0.0893],
        [-1.5765],
        [-1.1325],
        [ 0.0227],
        [-1.9573],
        [-2.1944],
        [ 0.6700],
        [-2.6541],
        [ 1.7208],
        [ 1.7015],
        [-2.5318],
        [-1.1851],
        [ 0.8689],
        [ 1.6078],
        [-1.3036],
        [-1.3176],
        [-2.4062],
        [-2.4433],
        [-2.6671],
        [ 0.3534],
        [-2.5267],
        [ 0.4681],
        [-1.6069],
        [-2.7539],
        [-2.7560],
        [ 2.8405],
        [ 1.9339],
        [ 2.6887],
        [ 0.5590],
        [-2.3317],
        [-2.6826],
        [ 0.0265],
        [ 1.1271],
        [-2.2539],
        [ 0.8391],
        [-1.7773],
        [-1.6216],
        [-0.7214],
        [-1.3262],
        [-0.6824],
        [ 0.5320],
        [-0.1115],
        [ 1.4483],
        [-0.8709],
        [-0.7481],
        [ 0.3244],
        [ 1.4164],
        [ 2.9447],
        [-2.1264],
        [ 0.8196],
        [-1.5372],
        [-2.4658],
        [ 0.9362],
        [-2.0755],
        [-1.5288],
        [-1.9794],
        [-1.4308],
        [ 2.1820],
        [ 2.7276],
        [ 0.2786],
        [-0.2973],
        [ 0.1811],
        [-2.1717],
        [ 0.2626],
        [ 0.4638],
        [-2.6617],
        [-2.8184],
        [-1.5286],
        [ 1.3001],
        [-2.0079],
        [-2.4447],
        [ 1.5923],
        [ 1.8507],
        [-2.1822],
        [ 1.9668],
        [ 2.0039],
        [-2.2413],
        [ 0.2957],
        [-1.6837],
        [ 1.8169],
        [-2.2153],
        [-1.1935],
        [ 1.0550],
        [ 2.4952],
        [ 2.1214],
        [-1.0059],
        [ 2.4426],
        [-0.0160],
        [-0.5975],
        [-1.9253],
        [-2.9670],
        [ 1.4951],
        [ 2.6286],
        [ 2.3460],
        [-0.9475],
        [ 0.1407],
        [-1.2314],
        [ 2.5645],
        [ 0.4022],
        [-1.6075],
        [-0.8345],
        [ 0.0821],
        [ 2.4569],
        [-0.6389],
        [ 0.4211],
        [ 1.9578],
        [-1.9007],
        [ 1.7414],
        [-0.6767],
        [ 0.3891],
        [ 1.9341],
        [-2.8330],
        [ 0.9264],
        [ 0.9351],
        [ 0.0597],
        [ 0.7707],
        [-2.5803],
        [ 2.4544],
        [-0.8705],
        [ 0.6311],
        [-1.6605],
        [-1.4060],
        [ 1.6639],
        [-0.4612],
        [ 1.4548],
        [ 2.3736],
        [ 2.2720],
        [ 0.6658],
        [ 1.9665],
        [-0.1410],
        [-1.6234],
        [-2.4335],
        [-0.7105],
        [-0.4503],
        [-0.1606],
        [ 0.3235],
        [-2.2722],
        [-0.8296],
        [-0.9409],
        [-1.5772],
        [ 2.7740],
        [ 2.9031],
        [-0.4791],
        [ 1.5603],
        [ 1.6302],
        [ 0.1337],
        [-0.9251],
        [-1.1284],
        [ 2.4247],
        [ 1.0608],
        [ 1.2087],
        [ 2.1275],
        [ 2.2850],
        [ 0.5284],
        [ 1.0125],
        [ 1.2055],
        [ 0.1705],
        [ 2.3086],
        [ 1.2509],
        [-1.0801],
        [ 2.9528],
        [-0.0538],
        [ 2.3657],
        [ 2.9026],
        [ 2.1784],
        [ 1.2759],
        [-2.1103],
        [ 0.3600],
        [ 2.1778],
        [ 2.2865],
        [-1.4542],
        [-2.6073],
        [-0.7372],
        [ 1.7721],
        [-0.6666],
        [-2.3352],
        [-1.7044],
        [-1.4261],
        [ 0.9410],
        [ 1.1413],
        [ 0.7592],
        [ 2.5096],
        [-2.2967],
        [ 2.8530],
        [ 0.4919],
        [ 0.1845],
        [-0.8492],
        [ 2.9532],
        [ 2.5581],
        [-0.5994],
        [ 0.8670],
        [-2.0504],
        [-0.3849],
        [-1.8180],
        [-1.1373],
        [ 1.1998],
        [ 0.9520],
        [ 1.9839],
        [ 1.9113],
        [ 1.5758],
        [ 0.3712],
        [ 1.9664],
        [-2.5512],
        [ 0.3255],
        [ 2.9437],
        [-0.3521],
        [-0.4156],
        [ 2.7058],
        [ 2.1166],
        [ 2.1431],
        [ 0.6660],
        [ 0.1828],
        [ 1.4508],
        [-2.4595],
        [-2.7674],
        [ 0.4328],
        [-2.7502],
        [-0.9478],
        [-2.1068],
        [-2.1654],
        [ 1.0416],
        [ 0.9762],
        [-0.6110],
        [ 2.0934],
        [-1.4458],
        [ 2.0785],
        [ 2.9708],
        [ 0.1117],
        [-1.0491],
        [ 1.7365],
        [-0.8362],
        [-2.0346],
        [-0.4266],
        [ 1.1352],
        [ 1.2687],
        [ 1.3262],
        [-2.7126],
        [ 1.9562],
        [-0.7542],
        [-2.3504],
        [ 0.5695],
        [ 0.4885],
        [ 1.7416],
        [-0.0858],
        [ 0.8570],
        [-2.6869],
        [ 1.1973],
        [ 0.7175],
        [ 1.3560],
        [ 0.7966],
        [-0.4148],
        [ 0.6553],
        [ 1.8455],
        [-0.7593],
        [ 1.0829],
        [ 0.6987],
        [-0.3256],
        [ 0.1501],
        [ 0.1482],
        [-2.3069],
        [-0.0361],
        [ 1.1291],
        [ 1.7972],
        [ 2.9616],
        [ 2.7198],
        [ 0.3562],
        [-0.0110],
        [-0.1055],
        [-2.5302],
        [-2.4837],
        [ 0.9650],
        [ 2.4224],
        [-1.5603],
        [ 0.4759],
        [ 0.5224],
        [-2.1242],
        [-2.0326],
        [-0.1923],
        [ 1.9511],
        [-1.1706],
        [ 0.0221],
        [ 2.0639],
        [ 0.3324],
        [ 2.9119],
        [-1.2789],
        [-2.0482],
        [-2.8808],
        [ 1.1849],
        [-0.4544],
        [-0.6532],
        [ 1.5803],
        [-1.2455],
        [ 2.6728],
        [-1.6271],
        [ 2.5626],
        [ 1.5769],
        [ 1.4931],
        [-1.4371],
        [-0.5009],
        [ 0.8002],
        [-2.1574],
        [-0.5243],
        [-0.0159],
        [-2.2229],
        [-2.9701],
        [-1.4659],
        [-1.4287],
        [ 2.8522],
        [ 0.4469],
        [-0.5441],
        [-1.6683],
        [ 2.5897],
        [-1.7291],
        [-1.4904],
        [ 0.8850],
        [ 2.8609],
        [ 0.6262],
        [ 2.0710],
        [ 2.3368],
        [-2.9313],
        [-0.2980],
        [-0.0255],
        [ 1.8244],
        [ 1.3141],
        [-1.3367],
        [ 0.8152],
        [ 1.0167],
        [ 2.4573],
        [ 0.5989],
        [-2.1960],
        [-1.3880],
        [-1.7536],
        [-0.2103],
        [ 1.2172],
        [-2.0171],
        [ 2.8581],
        [-1.6847],
        [-2.2361],
        [-0.9416],
        [ 1.7208],
        [ 1.8140],
        [ 1.5206],
        [ 0.8287],
        [-0.2040],
        [-2.5487],
        [ 2.4955],
        [ 0.3207],
        [ 0.4670],
        [ 1.5440],
        [-0.6579],
        [-0.0629],
        [ 1.7842],
        [ 2.0053],
        [-1.6157],
        [ 0.1799],
        [-0.2045],
        [-0.9897],
        [-0.9739],
        [ 1.4848],
        [ 2.4386],
        [ 1.6174],
        [ 0.8540],
        [-1.5994],
        [ 1.6058],
        [-0.2350],
        [-1.4164],
        [ 0.4176],
        [-0.5180],
        [ 0.7085],
        [-2.0381],
        [-2.2779],
        [ 1.3550],
        [ 1.1952],
        [-0.8587],
        [ 0.7309],
        [-0.7149],
        [-1.8547],
        [-1.0718],
        [ 1.5598],
        [ 1.7876],
        [-1.2915],
        [ 2.1138],
        [-1.5863],
        [-2.9690],
        [-1.5905],
        [-1.7552],
        [ 1.7430],
        [ 0.1270],
        [-2.0909],
        [ 2.0405],
        [ 1.0631],
        [ 0.9714],
        [-2.4748],
        [ 1.1195],
        [-0.8483],
        [-0.7202],
        [ 0.2314],
        [ 2.2124],
        [-1.5072],
        [-1.8761],
        [ 0.3240],
        [-1.2588],
        [ 0.4827],
        [-1.3734],
        [-1.6060],
        [-0.2975],
        [ 1.3047],
        [-1.3715],
        [ 2.2858],
        [-2.5920],
        [ 2.5862],
        [-1.4578],
        [ 0.8317],
        [ 0.1762],
        [ 0.3818],
        [ 0.8820],
        [-2.8101],
        [-0.0157],
        [-0.3228],
        [ 1.3827],
        [-0.4290],
        [ 2.7850],
        [ 1.3534],
        [-2.7710],
        [ 1.3126],
        [-0.2063],
        [ 0.9097],
        [ 2.9452],
        [ 2.4384],
        [ 1.9428],
        [ 1.1952],
        [ 0.3475],
        [ 0.3661],
        [ 0.5730],
        [-2.0996],
        [-1.4656],
        [-2.7812],
        [ 1.0180],
        [ 2.2210],
        [ 1.6591],
        [-1.6211],
        [ 2.6443],
        [ 2.0348],
        [-2.0049],
        [ 1.8489],
        [ 0.1828],
        [-0.6129],
        [-2.0590],
        [ 0.1752],
        [-2.5715],
        [ 1.3579],
        [-2.4488],
        [-1.3045],
        [ 2.0688],
        [-1.9636],
        [-0.3956],
        [ 1.0016],
        [-2.6138],
        [-0.8741],
        [-1.3843],
        [ 1.5420],
        [-2.9820],
        [ 0.4553],
        [ 2.8935],
        [-2.7102],
        [-1.0349],
        [-0.1524],
        [-1.4770],
        [ 2.4249],
        [-0.3900],
        [ 0.8027],
        [-1.0942],
        [-1.5531],
        [ 2.7746],
        [-0.0756],
        [-1.0708],
        [-0.7835],
        [-2.5578],
        [ 1.6314],
        [ 1.2933],
        [-2.9464],
        [ 1.2625],
        [-2.4663],
        [ 2.5669],
        [ 1.9000],
        [-1.6798],
        [-2.0492],
        [-0.5413],
        [-2.8162],
        [-2.8251],
        [ 0.6853],
        [ 1.2019],
        [ 2.6821],
        [ 0.1939],
        [-2.5320],
        [ 2.4185],
        [-2.1091],
        [ 0.4931],
        [ 2.2017],
        [ 1.6751],
        [ 0.6184],
        [-0.7112],
        [ 0.5335],
        [-2.8138],
        [-1.9305],
        [-0.6753],
        [ 2.6856],
        [-2.2844],
        [-1.0700],
        [ 1.7301],
        [-1.6925],
        [-0.1913],
        [-1.2682],
        [ 2.4775],
        [-2.7038],
        [ 2.1892],
        [-1.4484],
        [-1.3695],
        [-2.5450],
        [ 0.3641],
        [-1.6512],
        [ 1.6497],
        [ 0.2275],
        [ 2.2530],
        [-1.1468],
        [ 0.1322],
        [ 0.7365],
        [ 2.1631],
        [ 0.0272],
        [ 2.5455],
        [ 2.6274],
        [-0.7552],
        [-1.9772],
        [ 1.1687],
        [ 2.7204],
        [-2.0731],
        [ 1.8163],
        [ 0.5610],
        [ 0.1127],
        [ 2.3755],
        [-2.4645],
        [ 2.3416],
        [-1.5629],
        [ 1.9017],
        [ 2.7753],
        [ 1.8289],
        [ 1.4083],
        [ 0.1250],
        [-2.4408],
        [ 1.2267],
        [-1.2811],
        [ 1.1657],
        [-1.4694],
        [-1.9329],
        [ 2.2001],
        [-2.2824],
        [-1.2014],
        [-0.1982],
        [-0.0603],
        [-0.2769],
        [ 0.5161],
        [-2.5093],
        [-2.7391],
        [ 0.5050],
        [-1.9415],
        [-0.0463],
        [-1.9839],
        [ 1.4090],
        [-0.2735],
        [ 0.7603],
        [-1.7336],
        [-0.2264],
        [-2.7460],
        [ 2.8502],
        [-2.1504],
        [ 1.4375],
        [-2.2211],
        [-1.0572],
        [ 2.4688],
        [ 1.9850],
        [-2.7555],
        [-0.8931],
        [-1.8945],
        [-1.8321],
        [-0.1586],
        [ 0.0049],
        [-0.0056],
        [ 1.5266],
        [-1.9223],
        [ 0.4693],
        [-0.2791],
        [-0.1235],
        [-2.6614],
        [ 0.3639],
        [-2.3186],
        [-2.4844],
        [-0.3830],
        [-2.8164],
        [ 2.1421],
        [-2.3904],
        [-1.6032],
        [-2.0369],
        [-0.5080],
        [ 2.4234]])
Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 168, in <module>
    train_model(model, target, n_epochs, batch_size, n_context, n_components, eps, beta, alpha, optimizer, device)
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 96, in train_model
    log_target_j = target.log_prob(b_contexts, model_samples[:, j, ])
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_target.py", line 25, in log_prob
    means = self.mean_fn(contexts)
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_target.py", line 86, in cat_mean
    for i in range(n_components):
TypeError: 'str' object cannot be interpreted as an integer