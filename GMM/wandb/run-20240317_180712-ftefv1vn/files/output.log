Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 168, in <module>
    train_model(model, target, n_epochs, batch_size, n_context, n_components, eps, beta, alpha, optimizer, device)
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 69, in train_model
    cov_old = model.get_cov_matrix(chol_old)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1270, in __getattr__
    type(self).__name__, name))
AttributeError: 'ConditionalGMM' object has no attribute 'get_cov_matrix'
tensor([[-0.6014],
        [-2.5265],
        [ 0.9758],
        [-1.7247],
        [-2.9590],
        [-0.8407],
        [-2.6964],
        [ 1.9918],
        [-0.4272],
        [-0.3173],
        [-1.0731],
        [-1.1090],
        [-2.6871],
        [ 0.6219],
        [ 0.1276],
        [ 2.4906],
        [-1.0850],
        [ 0.8954],
        [-0.8867],
        [ 0.3227],
        [ 0.4917],
        [ 0.3996],
        [ 0.2996],
        [ 0.8851],
        [-0.7928],
        [-2.8270],
        [ 1.7007],
        [ 1.6048],
        [ 2.0264],
        [ 0.0828],
        [-1.5694],
        [-1.3765],
        [ 2.4851],
        [ 1.1064],
        [-0.0849],
        [ 1.6729],
        [-0.4887],
        [ 2.0768],
        [-2.2468],
        [-1.1058],
        [-0.8027],
        [-2.5601],
        [-2.0609],
        [ 2.3464],
        [-2.8891],
        [-0.4790],
        [ 2.3910],
        [-1.5538],
        [-2.9717],
        [-2.5997],
        [ 1.4224],
        [-0.3160],
        [ 2.1329],
        [ 0.0727],
        [ 0.2495],
        [-0.4902],
        [ 0.1211],
        [-1.8722],
        [-2.5821],
        [ 1.2208],
        [ 1.5090],
        [ 1.0593],
        [-2.5150],
        [ 1.6028],
        [ 1.1951],
        [ 0.2040],
        [ 0.7503],
        [ 1.7798],
        [-1.5213],
        [ 2.4526],
        [-0.2989],
        [ 1.6011],
        [ 1.7550],
        [-0.9359],
        [-1.0853],
        [-2.1737],
        [-2.0444],
        [ 0.1196],
        [ 0.9142],
        [-0.8665],
        [ 0.9291],
        [ 1.4528],
        [-1.2718],
        [ 1.3829],
        [-0.4518],
        [ 1.0384],
        [-0.2669],
        [ 0.0629],
        [-1.3157],
        [-0.1455],
        [-0.8630],
        [ 0.4037],
        [-0.2195],
        [-1.0299],
        [-2.0412],
        [-0.9604],
        [ 0.4949],
        [ 2.8324],
        [-2.5996],
        [-2.3134],
        [-0.6731],
        [ 1.4077],
        [-0.5106],
        [-1.4795],
        [-1.1093],
        [ 1.6385],
        [ 0.9823],
        [ 2.0806],
        [-1.0477],
        [-0.9622],
        [ 0.6053],
        [-1.2043],
        [-1.3365],
        [ 0.3975],
        [ 0.8539],
        [-0.8839],
        [-0.6178],
        [-0.4177],
        [ 1.5775],
        [-1.5686],
        [-1.8273],
        [ 0.2612],
        [-1.5910],
        [-0.7935],
        [ 1.3943],
        [ 2.1597],
        [ 1.5004],
        [ 2.7482],
        [ 1.9625],
        [ 0.4798],
        [ 2.9174],
        [ 0.7323],
        [ 1.4258],
        [ 2.7063],
        [-0.1794],
        [ 1.7813],
        [ 2.7463],
        [-2.6729],
        [ 2.8545],
        [ 0.2116],
        [-2.5243],
        [-2.7736],
        [ 2.0948],
        [-2.7395],
        [ 0.7141],
        [-0.6123],
        [ 1.0006],
        [-2.6255],
        [-2.6837],
        [ 2.3383],
        [-1.7591],
        [ 1.1000],
        [-2.8319],
        [ 2.4597],
        [ 0.0825],
        [-1.9873],
        [ 0.9692],
        [-2.2943],
        [ 2.1534],
        [ 2.8354],
        [ 2.9049],
        [ 1.0288],
        [ 0.8894],
        [-1.0037],
        [-0.9408],
        [-1.2410],
        [ 1.9719],
        [-0.3250],
        [ 0.8177],
        [ 0.2941],
        [-0.1856],
        [ 2.0933],
        [ 1.6600],
        [ 2.5326],
        [ 0.0647],
        [ 0.0386],
        [-2.2722],
        [ 2.4536],
        [-0.4051],
        [ 0.0703],
        [-1.5614],
        [-2.8877],
        [-2.3256],
        [-2.1207],
        [-2.6362],
        [-1.4446],
        [-1.9416],
        [ 1.4324],
        [ 2.9898],
        [ 2.1225],
        [-1.5937],
        [-2.4512],
        [ 2.2780],
        [-2.7030],
        [ 1.9700],
        [ 0.2485],
        [-2.6094],
        [-0.0689],
        [ 0.6558],
        [ 1.1244],
        [-2.5934],
        [ 0.2437],
        [-2.8977],
        [ 0.8530],
        [ 1.9550],
        [ 1.7483],
        [-1.5201],
        [-0.9135],
        [-2.0938],
        [ 0.6116],
        [ 1.7859],
        [ 1.9344],
        [-1.6036],
        [-2.0731],
        [-2.7923],
        [-1.3963],
        [-1.3562],
        [ 0.7122],
        [-0.7230],
        [-1.2478],
        [-1.8437],
        [ 0.2431],
        [-2.5132],
        [-1.9583],
        [ 0.1807],
        [ 1.7786],
        [-0.2027],
        [ 1.4124],
        [-2.2770],
        [ 1.2218],
        [-1.7546],
        [-0.3070],
        [ 2.2576],
        [-1.3700],
        [ 2.4707],
        [ 2.5300],
        [ 1.7223],
        [-0.9243],
        [-0.2032],
        [-2.2382],
        [-1.8274],
        [-0.8689],
        [-1.6294],
        [-0.3707],
        [-2.8926],
        [ 1.3407],
        [-2.0949],
        [ 1.2737],
        [-0.6332],
        [-2.7017],
        [-1.2810],
        [ 2.5020],
        [-1.7252],
        [-0.6899],
        [-1.5967],
        [ 1.1574],
        [-0.2022],
        [ 1.3117],
        [ 2.3458],
        [ 0.5764],
        [ 1.7289],
        [ 1.3056],
        [ 0.5222],
        [ 2.1558],
        [-0.5367],
        [-1.2779],
        [ 0.9241],
        [ 2.2331],
        [-0.0904],
        [-2.3770],
        [-2.5524],
        [ 2.9656],
        [-0.4036],
        [ 2.7151],
        [ 0.6498],
        [ 0.8516],
        [-1.1378],
        [-0.3201],
        [-1.1614],
        [-1.5002],
        [-0.3032],
        [ 1.4580],
        [ 0.9201],
        [-1.2465],
        [-2.1721],
        [ 0.1850],
        [-0.6221],
        [-0.4752],
        [-1.3958],
        [-2.8025],
        [-0.8310],
        [ 1.4888],
        [ 0.8758],
        [ 1.5730],
        [ 0.6413],
        [ 1.2814],
        [-1.2417],
        [-1.3842],
        [ 0.5966],
        [-1.2805],
        [ 2.0313],
        [-2.0289],
        [ 1.5557],
        [ 1.6966],
        [-0.9722],
        [ 2.8831],
        [ 1.8177],
        [-2.8085],
        [-0.8260],
        [ 1.1252],
        [ 1.2580],
        [ 1.3813],
        [ 0.5741],
        [ 0.8692],
        [ 2.1690],
        [ 1.5567],
        [-0.8625],
        [-0.9052],
        [-1.7562],
        [ 0.7545],
        [-2.6416],
        [ 1.8753],
        [-2.5000],
        [ 2.5139],
        [ 1.1172],
        [ 0.7254],
        [-2.9081],
        [ 0.6365],
        [ 0.9955],
        [-1.9976],
        [ 2.3147],
        [-2.6095],
        [-0.2939],
        [ 0.9795],
        [-2.4045],
        [ 0.4443],
        [ 1.6810],
        [-2.3336],
        [-2.1884],
        [ 0.5169],
        [ 1.8720],
        [-0.0097],
        [-0.6657],
        [ 1.4040],
        [ 2.5356],
        [-1.9253],
        [-2.3265],
        [ 0.4219],
        [ 2.7528],
        [ 2.0916],
        [ 2.0925],
        [-1.9636],
        [ 2.7752],
        [ 2.0615],
        [ 1.2248],
        [-0.1813],
        [-0.7687],
        [ 2.2757],
        [ 1.9162],
        [-1.0639],
        [ 2.0825],
        [-1.2978],
        [-1.3427],
        [ 0.0361],
        [ 2.3182],
        [-2.7795],
        [ 2.8164],
        [ 0.8765],
        [ 0.3238],
        [ 0.1519],
        [ 1.7748],
        [ 0.0838],
        [ 0.4520],
        [ 0.3093],
        [-1.0114],
        [-2.2295],
        [ 1.3029],
        [-0.0311],
        [ 1.7143],
        [-2.0852],
        [-1.1101],
        [-2.9760],
        [-1.3725],
        [-1.0250],
        [-0.6854],
        [-0.1812],
        [ 2.9292],
        [ 0.6130],
        [-1.7392],
        [ 2.0729],
        [-1.0603],
        [ 2.4002],
        [ 0.0306],
        [-0.5921],
        [ 1.1212],
        [-1.9379],
        [-2.9934],
        [ 1.2188],
        [ 1.6304],
        [ 2.2989],
        [ 0.0188],
        [-2.8559],
        [-2.5793],
        [-1.0882],
        [ 1.9696],
        [-1.4788],
        [-0.6606],
        [ 1.5533],
        [-1.9603],
        [-0.4293],
        [-1.1786],
        [-0.9117],
        [ 0.6504],
        [-2.3968],
        [ 2.5310],
        [ 1.3630],
        [ 2.2199],
        [ 2.0851],
        [ 2.7749],
        [-2.4547],
        [-0.8488],
        [-1.5711],
        [ 0.5271],
        [-2.2587],
        [ 2.2224],
        [ 1.5072],
        [ 0.7308],
        [-2.9909],
        [-1.9453],
        [-0.3679],
        [-0.1171],
        [ 0.0049],
        [-1.1203],
        [ 2.7830],
        [-2.8707],
        [ 2.9732],
        [ 0.2515],
        [-2.3040],
        [ 1.8243],
        [-2.8901],
        [ 2.0101],
        [-1.3442],
        [-1.3561],
        [ 2.2649],
        [-1.6118],
        [ 2.3591],
        [ 2.1682],
        [-0.3807],
        [ 0.5029],
        [ 1.7876],
        [ 0.2464],
        [ 1.9271],
        [ 1.6519],
        [ 1.5225],
        [-1.5990],
        [-0.4722],
        [ 0.3652],
        [-1.1070],
        [-0.8739],
        [-0.4682],
        [-2.2764],
        [-2.4020],
        [-1.7996],
        [-2.1145],
        [-1.5518],
        [ 1.5916],
        [-2.1637],
        [-0.5611],
        [ 1.2763],
        [ 0.2314],
        [ 0.5145],
        [ 1.7514],
        [ 1.0961],
        [ 1.0715],
        [-1.5925],
        [-2.0757],
        [-2.2578],
        [ 2.2156],
        [-2.7995],
        [ 0.8197],
        [-1.0428],
        [ 1.6678],
        [ 1.2890],
        [-2.5395],
        [-0.4373],
        [-2.3522],
        [-0.3379],
        [ 2.5909],
        [-2.6335],
        [ 1.1120],
        [-1.6505],
        [-2.9404],
        [-1.5991],
        [-0.8403],
        [-0.9001],
        [ 1.3105],
        [-1.0466],
        [ 1.1203],
        [-1.1316],
        [-2.3215],
        [ 0.4648],
        [ 1.0268],
        [-2.1008],
        [ 1.6447],
        [ 1.0392],
        [-2.4494],
        [-1.1733],
        [-0.1584],
        [-0.2505],
        [-2.0141],
        [ 0.3057],
        [-2.6104],
        [ 0.7675],
        [ 1.2799],
        [-2.0391],
        [-2.1771],
        [ 2.8897],
        [-2.8456],
        [ 1.1921],
        [ 2.5655],
        [ 1.9964],
        [-1.1136],
        [ 0.3162],
        [ 1.8463],
        [ 1.0984],
        [ 2.9286],
        [-1.2966],
        [ 0.3968],
        [-1.1275],
        [-0.0200],
        [ 2.7372],
        [-0.2712],
        [ 2.8659],
        [ 0.7567],
        [ 2.2427],
        [-0.4387],
        [ 0.6864],
        [ 0.0653],
        [ 0.4238],
        [-0.1577],
        [-1.1487],
        [-2.5875],
        [ 2.0441],
        [ 1.6820],
        [ 0.0652],
        [ 1.4215],
        [-1.6622],
        [ 0.1596],
        [-1.6500],
        [-0.8840],
        [-2.2814],
        [ 1.9098],
        [-1.6636],
        [ 2.7100],
        [-1.6717],
        [ 0.1465],
        [-0.0477],
        [ 2.7619],
        [ 2.9411],
        [-2.4459],
        [ 1.7937],
        [ 1.6730],
        [-1.3428],
        [ 2.0486],
        [-2.0034],
        [-1.2915],
        [ 2.7862],
        [-1.3844],
        [-2.2095],
        [-0.6231],
        [-2.0827],
        [ 0.2641],
        [-1.1068],
        [-0.1957],
        [ 0.5832],
        [-1.5272],
        [ 0.7794],
        [ 2.0495],
        [ 2.9953],
        [ 2.2864],
        [-1.2566],
        [-1.2738],
        [-1.6941],
        [ 1.8922],
        [-1.1111],
        [-1.0701],
        [-0.3443],
        [ 0.1415],
        [ 1.4254],
        [ 1.6062],
        [-0.2985],
        [-0.6163],
        [ 1.5838],
        [ 1.2035],
        [ 2.3493],
        [-2.4160],
        [ 0.0107],
        [ 2.5035],
        [ 0.7257],
        [ 0.0364],
        [ 1.6823],
        [-0.8036],
        [-0.4461],
        [-0.2078],
        [-0.7270],
        [-0.7648],
        [ 0.9472],
        [-2.2019],
        [ 1.0818],
        [ 2.3381],
        [ 1.7925],
        [ 0.4485],
        [ 2.9825],
        [ 2.3976],
        [ 2.5633],
        [-0.9498],
        [ 0.9148],
        [ 1.7607],
        [ 1.2147],
        [ 1.1770],
        [ 1.3471],
        [-0.3021],
        [-0.9387],
        [ 1.3682],
        [-0.2616],
        [-1.0017],
        [ 2.0477],
        [ 0.2558],
        [-0.1543],
        [ 1.6250],
        [-0.7286],
        [-2.5118],
        [ 1.2416],
        [ 2.6554],
        [ 1.9283],
        [ 0.1149],
        [ 2.1651],
        [ 2.3393],
        [ 0.2862],
        [ 2.7076],
        [-2.6330],
        [ 1.5362],
        [ 0.0507],
        [-0.4322],
        [ 1.9758],
        [-1.8326],
        [ 2.4356],
        [ 2.5770],
        [ 1.8615],
        [ 0.7197],
        [-1.0715],
        [-1.3996],
        [-0.0826],
        [-1.1446],
        [-1.5432],
        [-2.6592],
        [ 2.4986],
        [-2.9906],
        [ 2.4075],
        [ 0.4852],
        [ 0.0821],
        [ 1.3852],
        [ 2.2733],
        [ 1.7242],
        [ 0.4797],
        [-0.2945],
        [-0.0505],
        [-2.2535],
        [-2.7343],
        [-1.7326],
        [-0.3380],
        [ 0.4429],
        [ 0.9390],
        [-2.6089],
        [ 0.0687],
        [ 1.4057],
        [ 1.4122],
        [ 0.4164],
        [ 2.2236],
        [-2.9416],
        [ 2.4634],
        [ 0.1160],
        [ 1.3679],
        [ 1.1677],
        [-0.9372],
        [ 0.9982],
        [-2.6656],
        [ 1.2226],
        [ 2.4706],
        [-2.3682],
        [-2.3837],
        [ 0.8571],
        [ 0.6044],
        [-0.6971],
        [-1.7734],
        [-1.4042],
        [ 1.2056],
        [ 1.7919],
        [ 1.1566],
        [-0.5668],
        [-2.4103],
        [-0.9223],
        [ 2.4203],
        [-1.8818],
        [-1.7860],
        [ 1.6093],
        [-2.7107],
        [-0.4415],
        [-0.2092],
        [-2.3990],
        [ 2.1583],
        [ 1.2592],
        [ 1.6418],
        [ 1.8421],
        [ 2.3997],
        [-1.6596],
        [ 2.2264],
        [-2.0944],
        [ 2.8808],
        [ 2.4739],
        [-0.5583],
        [-1.2362],
        [ 2.8320],
        [ 0.3694],
        [ 0.3403],
        [-1.3791],
        [-1.4006],
        [ 1.1746],
        [-2.5724],
        [ 0.2524],
        [ 1.4397],
        [ 0.1145],
        [-2.1959],
        [ 1.1046],
        [ 1.9578],
        [ 1.9471],
        [ 2.5951],
        [-0.0865],
        [-1.1290],
        [-1.5048],
        [-0.0751],
        [-2.7802],
        [ 0.0631],
        [-0.1951],
        [-1.4475],
        [ 2.1270],
        [-2.1640],
        [ 1.3530],
        [-1.3281],
        [ 1.0177],
        [-1.5961],
        [-1.2500],
        [ 1.3708],
        [ 0.8072],
        [ 2.5253],
        [ 0.2042],
        [ 0.6348],
        [-1.5958],
        [ 0.7422],
        [ 0.3694],
        [-1.8713],
        [ 2.6133],
        [ 0.5313],
        [ 1.9425],
        [ 2.7268],
        [ 0.0224],
        [-0.3371],
        [ 0.1853],
        [-0.6398],
        [ 2.5465],
        [ 1.1949],
        [-1.7924],
        [-1.3149],
        [-2.9343],
        [ 1.4671],
        [-1.7366],
        [ 2.9673],
        [-2.1559],
        [-2.3109],
        [-1.7968],
        [ 0.1215],
        [-0.4533],
        [-0.0383],
        [ 0.7844],
        [-2.7922],
        [ 1.1350],
        [ 2.1744],
        [ 0.3280],
        [ 0.6239],
        [-1.8278],
        [ 0.5781],
        [-1.1288],
        [-2.3255],
        [ 2.2262],
        [ 2.3695],
        [-0.9823],
        [ 0.0580],
        [ 2.2009],
        [-0.6601],
        [-2.0565],
        [-2.5042],
        [ 1.5125],
        [-0.6557],
        [-1.9362],
        [-2.9143],
        [ 0.3175],
        [-2.8979],
        [ 1.0853],
        [ 0.7708],
        [-0.3522],
        [ 1.6312],
        [-2.0285],
        [-0.9630],
        [-1.1999],
        [ 1.3937],
        [-2.9593],
        [-2.2169],
        [ 0.2524],
        [-1.9921],
        [-1.7053],
        [-2.3297],
        [ 1.7870],
        [ 2.7009],
        [-1.9695],
        [ 2.5790],
        [ 2.8396],
        [ 1.3348],
        [-2.4103],
        [ 0.9561],
        [-1.7012],
        [-1.8033],
        [-0.4888],
        [ 1.8696],
        [-2.3830],
        [-1.3198],
        [ 2.9156],
        [ 1.9337],
        [ 2.3895],
        [-1.0642],
        [-2.6031],
        [-2.3690],
        [ 0.4024],
        [ 0.1031],
        [ 1.4221],
        [-2.6119],
        [-1.1959],
        [-2.0465],
        [-0.0845],
        [-1.5688],
        [-0.7220],
        [-1.2765],
        [ 2.5330],
        [ 2.9316],
        [-0.9060],
        [-1.1748],
        [ 1.6054],
        [ 0.8595],
        [ 0.4023],
        [-1.2477],
        [-0.7048],
        [-1.3141],
        [ 1.9027],
        [ 2.2372],
        [-2.7796],
        [-2.0945],
        [-2.8740],
        [ 2.1546],
        [-1.7720],
        [-1.0016],
        [-2.4643],
        [ 1.0256],
        [-1.3298],
        [ 2.9704],
        [-0.0675],
        [ 0.1841],
        [ 1.4254],
        [ 0.6296],
        [ 2.2172],
        [ 0.3387],
        [ 2.7578],
        [-2.0409],
        [-2.7907],
        [-0.8824],
        [-1.6817],
        [-1.7114],
        [-2.3967],
        [-0.5471],
        [-1.7739],
        [-0.0314],
        [ 0.7875],
        [ 0.1740],
        [ 2.7734],
        [-2.1518],
        [-1.2757],
        [ 0.2194],
        [-2.5926],
        [ 2.1960],
        [ 2.4844],
        [ 2.1128],
        [ 1.1198],
        [ 0.4654],
        [ 1.9059],
        [-2.9459],
        [-0.7618],
        [ 1.1988],
        [-2.2330],
        [ 0.2346],
        [-0.5110],
        [ 2.8491],
        [-2.8259],
        [ 1.7268],
        [-2.5139],
        [-0.6336],
        [-1.3313],
        [-1.4105],
        [ 2.3191],
        [-0.8118],
        [-2.0646],
        [ 1.4920],
        [ 0.8436],
        [ 0.7788],
        [ 0.2661],
        [ 0.6663],
        [-1.8814],
        [ 1.6469],
        [ 2.2906],
        [-2.2174],
        [ 1.7279],
        [-2.9427],
        [ 2.7326],
        [ 0.9132],
        [-0.0209],
        [-0.3552],
        [ 0.5651],
        [-2.8992],
        [-1.7139],
        [ 2.6891],
        [-2.6711],
        [-1.6389],
        [ 2.9336],
        [-2.2276],
        [ 2.8586],
        [ 2.4677],
        [ 0.1800],
        [ 1.8005],
        [ 2.7640],
        [ 1.3983],
        [-2.2748],
        [ 2.1614],
        [-0.6292],
        [ 2.5160],
        [-2.9108],
        [-1.5758],
        [ 1.4071],
        [-0.7459],
        [ 0.5175],
        [ 2.7280],
        [ 0.3854],
        [-2.9897],
        [-0.6513]])