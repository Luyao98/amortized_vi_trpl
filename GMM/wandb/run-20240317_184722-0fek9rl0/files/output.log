Traceback (most recent call last):
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 167, in <module>
    train_model(model, target, n_epochs, batch_size, n_context, n_components, eps, beta, alpha, optimizer, device)
  File "/home/luyao/amortized_vi_trpl/GMM/GMM_model.py", line 114, in train_model
    loss.backward(retain_graph=True)
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/luyao/miniconda3/envs/ITPAL_luyao/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
RuntimeError: one of the variables needed for gradient computation has been modified by an inplace operation: [torch.FloatTensor [64, 3]], which is output 0 of AsStridedBackward0, is at version 2; expected version 1 instead. Hint: enable anomaly detection to find the operation that failed to compute its gradient, with torch.autograd.set_detect_anomaly(True).
tensor([[ 0.6162],
        [ 2.3222],
        [ 1.2772],
        [ 1.6122],
        [-2.4668],
        [-1.0552],
        [ 1.1585],
        [-1.5986],
        [ 1.1966],
        [-0.0057],
        [ 0.6853],
        [-2.8092],
        [-0.4055],
        [ 2.2214],
        [ 2.9332],
        [-2.9400],
        [-2.0638],
        [ 1.9136],
        [ 1.4661],
        [ 2.7315],
        [-2.4469],
        [-2.8910],
        [-0.8593],
        [ 1.6155],
        [ 1.3851],
        [ 1.5981],
        [ 0.2516],
        [ 1.2723],
        [-2.2492],
        [-0.8027],
        [-0.8931],
        [-0.7573],
        [ 1.5778],
        [ 0.0791],
        [-2.1234],
        [ 1.4978],
        [ 0.0658],
        [ 0.2165],
        [-0.2025],
        [ 0.2843],
        [ 0.6373],
        [ 0.8250],
        [ 0.6003],
        [-2.4997],
        [-2.1560],
        [-1.0048],
        [-2.2539],
        [ 1.1238],
        [-0.6691],
        [ 0.2005],
        [ 0.7798],
        [-0.6969],
        [ 2.6108],
        [-0.4048],
        [-2.5282],
        [ 1.7960],
        [ 0.0874],
        [-0.0165],
        [-0.5578],
        [-1.9176],
        [ 1.5162],
        [-1.0901],
        [-1.8741],
        [ 2.3433],
        [ 0.3898],
        [-2.6660],
        [ 0.0327],
        [-1.7947],
        [ 2.9264],
        [-1.6582],
        [-1.2259],
        [ 0.1920],
        [ 2.5972],
        [ 1.0443],
        [ 2.3504],
        [ 0.5543],
        [ 0.8072],
        [ 2.9061],
        [ 2.6775],
        [-1.4244],
        [-1.6902],
        [ 1.1208],
        [-0.2471],
        [ 2.1071],
        [-2.8400],
        [ 2.3946],
        [ 0.7186],
        [ 0.2299],
        [-1.2227],
        [ 2.3006],
        [ 2.7492],
        [ 2.2404],
        [ 2.7266],
        [-0.5458],
        [-0.5795],
        [ 2.2187],
        [-0.2984],
        [-1.0796],
        [ 1.4499],
        [ 1.0987],
        [-0.3691],
        [ 1.4385],
        [ 0.6417],
        [ 2.4261],
        [-2.0432],
        [-1.5795],
        [ 1.5587],
        [-2.3457],
        [ 2.4737],
        [-2.5293],
        [-1.7063],
        [-2.1425],
        [-1.5076],
        [ 1.3290],
        [ 0.1965],
        [ 0.9340],
        [ 1.4883],
        [ 1.4333],
        [ 2.8319],
        [-0.6456],
        [ 0.3346],
        [ 1.2888],
        [-0.0098],
        [ 2.9157],
        [-2.7227],
        [-2.6839],
        [-1.7886],
        [-2.9879],
        [ 1.8960],
        [-1.6820],
        [-0.0232],
        [-2.2218],
        [ 0.5901],
        [-0.3365],
        [ 2.2130],
        [ 0.4943],
        [-0.9861],
        [ 0.4030],
        [ 0.2673],
        [ 2.3409],
        [ 2.1108],
        [ 0.1078],
        [ 0.9714],
        [ 1.6167],
        [-2.6345],
        [ 1.1864],
        [-2.2804],
        [-1.8393],
        [-1.0167],
        [ 1.9842],
        [ 2.8589],
        [ 1.4091],
        [-2.5833],
        [ 1.4631],
        [-1.8634],
        [-2.6624],
        [-2.5679],
        [-0.1430],
        [-1.0738],
        [-2.8295],
        [ 2.1337],
        [ 2.9864],
        [-0.5153],
        [ 0.7884],
        [ 2.7166],
        [ 2.9979],
        [-2.5565],
        [ 0.6576],
        [ 1.9002],
        [ 1.8421],
        [ 1.5710],
        [-0.8148],
        [-1.9142],
        [ 0.3382],
        [-1.7780],
        [ 0.5240],
        [-0.0321],
        [ 1.5544],
        [-2.5115],
        [ 0.7691],
        [-0.3627],
        [-1.2372],
        [ 2.0924],
        [-0.1019],
        [ 1.4310],
        [ 2.2538],
        [ 1.3022],
        [-1.4330],
        [-1.6190],
        [ 2.5996],
        [-1.3466],
        [ 0.3312],
        [ 2.5212],
        [ 0.2219],
        [ 0.9043],
        [-1.0096],
        [ 2.0434],
        [ 2.1848],
        [ 2.0684],
        [ 0.2597],
        [-2.0556],
        [-2.5940],
        [ 1.0159],
        [ 2.0156],
        [ 1.1210],
        [ 1.0113],
        [-2.5819],
        [-2.4235],
        [ 1.3572],
        [-0.9599],
        [-2.5506],
        [ 0.5955],
        [-0.9409],
        [-0.5921],
        [-0.2347],
        [-2.0994],
        [-2.8242],
        [-2.7883],
        [-1.9416],
        [ 0.4505],
        [ 2.8903],
        [ 0.4321],
        [-2.4479],
        [-1.4686],
        [-0.8703],
        [-2.8869],
        [-1.5193],
        [ 0.7740],
        [-2.3108],
        [-0.0709],
        [-1.9677],
        [ 2.1421],
        [-1.5121],
        [ 0.6737],
        [ 0.7246],
        [ 0.1318],
        [ 0.9408],
        [-0.6197],
        [ 0.4656],
        [ 0.1991],
        [ 0.6987],
        [-1.6646],
        [-2.1337],
        [ 1.6302],
        [-0.6191],
        [-0.8992],
        [ 1.0519],
        [-1.6065],
        [ 0.5432],
        [-2.2713],
        [ 1.8640],
        [ 2.6723],
        [-0.5981],
        [-1.2525],
        [-2.4961],
        [ 1.4933],
        [ 2.4479],
        [-1.3700],
        [ 1.5400],
        [-0.9452],
        [-0.9623],
        [ 1.2687],
        [ 2.0449],
        [-0.3946],
        [ 0.9463],
        [-1.5779],
        [-0.5014],
        [-2.6327],
        [-2.2460],
        [ 2.1116],
        [-1.3354],
        [ 2.8386],
        [-1.1774],
        [ 2.7365],
        [-2.3022],
        [ 1.9461],
        [-0.7320],
        [ 2.2099],
        [-1.8280],
        [-2.9325],
        [ 2.6342],
        [-0.7634],
        [-2.5377],
        [ 2.2606],
        [-0.5816],
        [-1.4150],
        [ 1.4215],
        [-0.5769],
        [ 1.4711],
        [ 0.6807],
        [ 1.3173],
        [-0.6815],
        [ 0.3009],
        [-2.6571],
        [-1.4254],
        [-1.0030],
        [-0.9539],
        [ 1.3724],
        [-0.0933],
        [ 2.8752],
        [-0.3936],
        [-2.7258],
        [ 0.6814],
        [ 0.1046],
        [ 0.9807],
        [ 2.1804],
        [ 1.7812],
        [ 0.6909],
        [ 1.0422],
        [-0.3656],
        [-0.5391],
        [-1.6394],
        [-2.4363],
        [ 0.3507],
        [ 0.1498],
        [-2.2334],
        [-2.1110],
        [ 1.8613],
        [ 2.4193],
        [-1.4485],
        [ 0.6037],
        [-1.2699],
        [ 1.1078],
        [ 0.5867],
        [-0.0392],
        [-1.2227],
        [ 0.2409],
        [-2.1057],
        [-1.1000],
        [ 2.1482],
        [ 1.4504],
        [ 0.2952],
        [ 0.0972],
        [ 1.2811],
        [ 0.8492],
        [-0.6175],
        [-1.3661],
        [ 2.9125],
        [-1.9510],
        [ 1.7709],
        [-0.0137],
        [-2.4118],
        [-2.0658],
        [ 1.8269],
        [ 0.6408],
        [ 2.3519],
        [ 0.4561],
        [ 2.6629],
        [-0.2201],
        [ 0.6116],
        [ 0.6561],
        [ 2.6557],
        [ 0.7453],
        [ 0.2858],
        [-1.2395],
        [ 1.9703],
        [ 1.0188],
        [ 2.1131],
        [ 0.4290],
        [-1.7963],
        [-1.4499],
        [ 1.4501],
        [-2.0589],
        [-2.1178],
        [ 2.7057],
        [-2.0773],
        [ 2.2360],
        [-0.0049],
        [ 1.6091],
        [-0.7088],
        [ 0.7882],
        [-0.5918],
        [ 1.2469],
        [ 0.0452],
        [-2.1513],
        [ 2.1246],
        [-2.0682],
        [-2.1223],
        [ 1.8529],
        [-2.8582],
        [ 2.1126],
        [ 1.6302],
        [-0.6902],
        [ 1.3221],
        [ 0.3992],
        [-0.5287],
        [ 0.6852],
        [ 1.7809],
        [ 0.2817],
        [-2.9552],
        [-1.0048],
        [ 1.6183],
        [ 1.4065],
        [ 2.5835],
        [-0.7249],
        [ 2.1028],
        [ 2.5744],
        [ 1.7723],
        [-1.2945],
        [ 1.3868],
        [ 2.5330],
        [ 0.6927],
        [-1.5547],
        [ 2.1323],
        [-2.3185],
        [ 2.8743],
        [ 2.7332],
        [ 2.4371],
        [ 0.7981],
        [ 0.7041],
        [ 0.5926],
        [-2.6769],
        [ 1.0261],
        [ 1.6325],
        [ 1.6230],
        [ 2.3114],
        [-1.7578],
        [-1.7841],
        [-1.0976],
        [-1.0174],
        [ 0.8408],
        [-1.4615],
        [-1.5273],
        [-0.1788],
        [ 1.6964],
        [-0.8721],
        [ 1.7934],
        [-2.1624],
        [-2.2312],
        [ 2.2964],
        [-1.9490],
        [ 0.0488],
        [-1.9610],
        [-1.8054],
        [-1.7628],
        [-0.6497],
        [-1.2102],
        [-0.6236],
        [-2.0953],
        [-0.1273],
        [-0.4493],
        [ 1.7195],
        [-1.7535],
        [ 1.8709],
        [-2.0926],
        [ 2.1643],
        [ 0.4634],
        [ 0.3767],
        [-0.9999],
        [-0.4184],
        [ 1.1273],
        [-2.7470],
        [ 0.5012],
        [-1.4096],
        [ 2.2183],
        [-2.2380],
        [-0.1599],
        [-2.0399],
        [-1.4704],
        [-2.2093],
        [ 2.7770],
        [-1.8206],
        [-1.6834],
        [ 2.4098],
        [-2.8813],
        [ 2.8516],
        [-1.7042],
        [-2.7414],
        [ 2.6114],
        [-0.1855],
        [ 0.7290],
        [ 1.4607],
        [-1.1869],
        [-1.5403],
        [-2.5910],
        [-2.4437],
        [-1.6182],
        [ 0.5061],
        [-0.8454],
        [-2.1985],
        [ 0.0835],
        [-2.8958],
        [-0.6891],
        [-1.9783],
        [-2.3208],
        [-0.2141],
        [-1.3644],
        [ 0.9419],
        [-0.4284],
        [ 1.2060],
        [-1.1793],
        [ 2.1569],
        [ 0.6997],
        [-1.8488],
        [ 2.4856],
        [-1.5128],
        [ 0.0215],
        [-1.1931],
        [-1.1769],
        [-1.2237],
        [-2.7460],
        [ 1.1542],
        [-2.3960],
        [-1.1434],
        [ 2.8219],
        [ 2.2424],
        [-1.0211],
        [ 1.1165],
        [ 1.1513],
        [-0.4541],
        [ 0.9479],
        [ 2.3736],
        [-0.7768],
        [ 0.3936],
        [-2.5222],
        [-0.2030],
        [-1.7771],
        [ 0.3688],
        [-2.3785],
        [-1.0715],
        [-1.4356],
        [ 2.0385],
        [-2.4958],
        [ 1.9795],
        [-0.5201],
        [-2.7068],
        [ 0.3088],
        [ 0.4625],
        [ 0.6108],
        [-1.8823],
        [ 2.9134],
        [ 0.1078],
        [ 1.1973],
        [ 2.5867],
        [-1.8599],
        [-2.0889],
        [-2.3220],
        [ 0.2679],
        [ 1.4393],
        [-0.5320],
        [-0.1518],
        [ 1.4674],
        [ 2.6341],
        [-2.2508],
        [ 1.6090],
        [ 0.0223],
        [-0.8294],
        [ 0.3149],
        [-1.0610],
        [ 0.2684],
        [ 2.2908],
        [ 2.9385],
        [ 2.6478],
        [-0.7693],
        [-2.0272],
        [-2.3183],
        [-0.3067],
        [-0.6870],
        [-0.5688],
        [-0.5556],
        [-2.3737],
        [ 2.5702],
        [ 1.0581],
        [ 0.2663],
        [ 0.8714],
        [-0.9423],
        [-2.8038],
        [-1.9010],
        [ 2.6732],
        [-1.5555],
        [ 1.0382],
        [-0.4398],
        [ 1.8720],
        [-0.2908],
        [ 0.6677],
        [-2.1952],
        [-2.5719],
        [ 1.1536],
        [ 2.3596],
        [-1.9995],
        [ 1.9896],
        [-1.9404],
        [ 0.4084],
        [-1.1215],
        [ 2.5828],
        [ 1.4910],
        [-2.0706],
        [ 0.6185],
        [-0.8033],
        [ 1.3911],
        [-1.8578],
        [-2.7785],
        [ 1.1577],
        [ 1.3489],
        [ 2.8822],
        [ 0.6922],
        [-1.6379],
        [-0.2235],
        [ 1.7336],
        [ 1.3456],
        [ 2.4457],
        [-0.5885],
        [ 0.0108],
        [-0.9138],
        [-0.0125],
        [ 2.8612],
        [ 2.2670],
        [-2.1728],
        [-2.8431],
        [-1.9587],
        [ 0.4523],
        [ 0.2772],
        [ 2.5431],
        [-0.5181],
        [ 2.1580],
        [ 0.3470],
        [-1.7940],
        [-2.1981],
        [ 2.7233],
        [ 1.2072],
        [ 2.1467],
        [ 0.0421],
        [ 1.7622],
        [-1.5125],
        [-2.7005],
        [ 0.5099],
        [-1.9197],
        [-2.3032],
        [ 0.7841],
        [ 0.7987],
        [ 0.0644],
        [ 1.4995],
        [ 1.5959],
        [ 0.0647],
        [ 2.2333],
        [ 0.9350],
        [ 2.8151],
        [ 1.0437],
        [-1.6554],
        [ 1.5869],
        [-2.8616],
        [ 1.9192],
        [-1.6639],
        [ 0.3116],
        [ 1.5086],
        [ 1.6765],
        [ 1.4006],
        [ 0.4544],
        [ 0.0456],
        [-0.8437],
        [ 0.1957],
        [-1.5255],
        [-1.2222],
        [ 2.3679],
        [-2.4703],
        [-2.5710],
        [-1.7895],
        [ 1.9010],
        [ 1.7629],
        [ 1.2876],
        [-2.6849],
        [-2.3368],
        [ 2.9672],
        [ 0.0131],
        [-2.9954],
        [ 2.4607],
        [-0.8926],
        [-0.7842],
        [-0.0597],
        [-1.6097],
        [-2.1481],
        [ 1.3614],
        [-0.9649],
        [ 0.4527],
        [ 0.2463],
        [-0.3808],
        [ 2.0221],
        [ 2.2061],
        [ 0.1895],
        [-1.4144],
        [-0.9640],
        [ 2.5857],
        [-2.9569],
        [ 0.0271],
        [ 2.5976],
        [ 2.6892],
        [-1.2662],
        [-0.3760],
        [-2.7584],
        [ 1.1031],
        [-1.4418],
        [-2.2257],
        [-0.2470],
        [-2.8053],
        [-0.6940],
        [ 0.6219],
        [ 2.0354],
        [-1.2185],
        [-0.1327],
        [ 0.1608],
        [ 0.2891],
        [ 1.1326],
        [ 2.9739],
        [-0.7784],
        [-0.3851],
        [-1.0121],
        [ 1.8734],
        [ 1.6861],
        [ 2.0552],
        [-0.0938],
        [-2.7525],
        [ 1.5542],
        [-1.9306],
        [-0.1105],
        [ 0.8797],
        [ 0.9811],
        [ 2.0163],
        [-0.4387],
        [ 2.9023],
        [ 0.4549],
        [-2.1805],
        [ 1.2187],
        [-0.2118],
        [-1.9431],
        [ 2.5255],
        [ 2.3285],
        [ 2.3781],
        [-0.9504],
        [-0.8180],
        [ 0.2318],
        [ 1.1523],
        [ 1.8429],
        [ 2.8853],
        [-0.8660],
        [ 1.5318],
        [ 0.7844],
        [-0.2243],
        [-2.4997],
        [-0.6222],
        [-1.7272],
        [-0.0335],
        [ 2.7545],
        [ 0.3140],
        [-2.0995],
        [ 0.0711],
        [ 2.2910],
        [ 1.1397],
        [ 2.8635],
        [-1.9371],
        [ 1.4843],
        [-0.3442],
        [ 0.9213],
        [ 0.9064],
        [-2.6844],
        [-1.2313],
        [ 1.3475],
        [-1.3923],
        [-1.1084],
        [ 0.0353],
        [ 1.3573],
        [-2.6271],
        [-2.0912],
        [-1.9706],
        [ 0.7411],
        [-0.8918],
        [-1.6709],
        [ 1.2456],
        [-1.6651],
        [-1.9041],
        [-0.0578],
        [ 1.0875],
        [ 1.6459],
        [-0.0273],
        [ 1.1986],
        [-2.3824],
        [-2.3754],
        [-1.1089],
        [ 0.3327],
        [ 2.7114],
        [ 2.7205],
        [-2.0899],
        [ 2.7685],
        [ 0.5499],
        [-1.2726],
        [-0.3087],
        [-2.8394],
        [-2.3080],
        [ 2.4853],
        [ 1.2062],
        [ 1.6448],
        [-1.2288],
        [-0.9581],
        [-1.1420],
        [ 2.2826],
        [ 0.8986],
        [-0.1795],
        [ 1.8714],
        [ 0.6101],
        [-0.3029],
        [ 0.9551],
        [-1.5083],
        [ 2.7149],
        [-2.6700],
        [-1.8362],
        [-1.4555],
        [-1.4081],
        [ 2.3656],
        [ 0.2089],
        [ 1.7863],
        [-2.2707],
        [-1.0320],
        [-2.1108],
        [-1.4206],
        [ 0.9703],
        [-1.8449],
        [-0.4848],
        [ 1.4199],
        [-0.0746],
        [ 1.9983],
        [ 1.7831],
        [-0.3111],
        [ 0.5377],
        [-2.0823],
        [-2.3204],
        [ 0.7508],
        [-1.7290],
        [ 1.5731],
        [-2.9017],
        [ 0.1949],
        [ 0.9962],
        [ 0.5534],
        [-2.2289],
        [-0.9292],
        [-2.4524],
        [-1.4860],
        [ 1.9273],
        [ 2.5452],
        [ 2.2419],
        [-0.3461],
        [-2.5412],
        [-1.7940],
        [-0.1705],
        [-0.9025],
        [-0.6654],
        [-2.4208],
        [-0.2783],
        [ 2.3409],
        [ 1.5423],
        [ 2.6533],
        [ 2.5963],
        [ 0.1820],
        [ 2.7571],
        [-0.9537],
        [ 0.8603],
        [-0.2137],
        [ 2.0506],
        [-2.4155],
        [ 1.9248],
        [ 2.0921],
        [ 1.8377],
        [ 1.0927],
        [ 0.4547],
        [-2.2524],
        [-0.8570],
        [-0.2110],
        [-1.5769],
        [-0.4253],
        [-0.0873],
        [ 0.5777],
        [-0.3618],
        [ 1.7588],
        [ 2.6134],
        [-1.9419],
        [ 1.5088],
        [-0.0124],
        [ 2.0639],
        [ 1.1990],
        [ 1.8162],
        [-1.5733],
        [ 0.5607],
        [ 0.5319],
        [-2.2124],
        [ 1.8578],
        [ 0.3669],
        [ 2.5171],
        [ 0.4355],
        [ 0.2015],
        [ 2.1362],
        [-0.6080],
        [-1.2916],
        [-2.8847],
        [-1.1156],
        [-0.4621],
        [-0.5989],
        [ 0.4481],
        [ 1.3174],
        [-2.6096],
        [-0.3415],
        [-1.8581],
        [-2.6842],
        [ 0.4405],
        [ 1.9768],
        [ 2.2682],
        [ 2.6360],
        [-0.4784],
        [-1.8140],
        [-0.9422],
        [-0.7788],
        [-2.5255],
        [ 0.0573],
        [-2.8298],
        [-0.9406],
        [ 1.9643],
        [-1.3224],
        [ 1.6310],
        [ 1.0700],
        [ 0.4521],
        [ 2.8203],
        [ 2.1275],
        [-0.8768],
        [ 0.5325],
        [-1.6463],
        [-2.1976],
        [-0.2881],
        [ 2.6337],
        [ 2.2024],
        [ 2.1698],
        [-2.5554],
        [-0.1090],
        [ 0.8489],
        [ 2.9774],
        [-1.8078],
        [ 0.9526],
        [ 2.4512],
        [ 0.5943],
        [-1.3877],
        [-0.8425],
        [-0.0410],
        [-2.8099],
        [-0.9296],
        [-2.8746],
        [ 0.0745],
        [-1.5764],
        [ 2.3153],
        [-1.4858],
        [-2.0077],
        [-2.0193],
        [-2.9331],
        [-2.4534],
        [-1.2430],
        [ 2.3749],
        [-0.0475],
        [ 1.2265],
        [ 0.5094],
        [ 0.5535],
        [-0.9939],
        [-1.4594],
        [ 2.7459],
        [ 2.3694],
        [-0.4919]])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])
torch.Size([64])